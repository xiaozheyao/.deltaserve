/mnt/hwfile/huqinghao/miniconda3/bin/python
2024-05-06 04:26:55,653 - INFO - Note: detected 128 virtual cores but NumExpr set to maximum of 64, check "NUMEXPR_MAX_THREADS" environment variable.
2024-05-06 04:26:55,653 - INFO - Note: NumExpr detected 128 cores but "NUMEXPR_MAX_THREADS" not set, so enforcing safe limit of 8.
2024-05-06 04:26:55,653 - INFO - NumExpr defaulting to 8 threads.
2024-05-06 04:26:57,160	INFO scripts.py:1182 -- Did not find any active Ray processes.

==========
== CUDA ==
==========

CUDA Version 12.1.0

Container image Copyright (c) 2016-2023, NVIDIA CORPORATION & AFFILIATES. All rights reserved.

This container image and its contents are governed by the NVIDIA Deep Learning Container License.
By pulling and using the container, you accept the terms and conditions of this license:
https://developer.nvidia.com/ngc/nvidia-deep-learning-container-license

A copy of this license is made available in this container at /NGC-DL-CONTAINER-LICENSE for your convenience.

*************************
** DEPRECATION NOTICE! **
*************************
THIS IMAGE IS DEPRECATED and is scheduled for DELETION.
    https://gitlab.com/nvidia/container-images/cuda/blob/master/doc/support-policy.md

Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fba8460>: Failed to establish a new connection: [Errno 111] Connection refused'))
/usr/local/lib/python3.10/dist-packages/pydantic/_internal/_fields.py:160: UserWarning: Field "model_name_or_path" has conflict with protected namespace "model_".

You may be able to resolve this warning by setting `model_config['protected_namespaces'] = ()`.
  warnings.warn(
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fba91e0>: Failed to establish a new connection: [Errno 111] Connection refused'))
INFO 05-06 04:27:09 api_server.py:202] vLLM API server version 0.3.3
INFO 05-06 04:27:09 api_server.py:203] args: Namespace(host=None, port=8000, uvicorn_log_level='info', allow_credentials=False, allowed_origins=['*'], allowed_methods=['*'], allowed_headers=['*'], api_key=None, served_model_name=None, lora_modules=[], delta_modules=[Delta(name='delta-1', local_path='/vllm/.idea/models/70b/llama2-chat-70b.4b75s128g-bitblas-tp_4-1'), Delta(name='delta-2', local_path='/vllm/.idea/models/70b/llama2-chat-70b.4b75s128g-bitblas-tp_4-2'), Delta(name='delta-3', local_path='/vllm/.idea/models/70b/llama2-chat-70b.4b75s128g-bitblas-tp_4-3'), Delta(name='delta-4', local_path='/vllm/.idea/models/70b/llama2-chat-70b.4b75s128g-bitblas-tp_4-4'), Delta(name='delta-5', local_path='/vllm/.idea/models/70b/llama2-chat-70b.4b75s128g-bitblas-tp_4-5'), Delta(name='delta-6', local_path='/vllm/.idea/models/70b/llama2-chat-70b.4b75s128g-bitblas-tp_4-6'), Delta(name='delta-7', local_path='/vllm/.idea/models/70b/llama2-chat-70b.4b75s128g-bitblas-tp_4-7'), Delta(name='delta-8', local_path='/vllm/.idea/models/70b/llama2-chat-70b.4b75s128g-bitblas-tp_4-8')], swap_modules=[], chat_template=None, response_role='assistant', ssl_keyfile=None, ssl_certfile=None, ssl_ca_certs=None, ssl_cert_reqs=0, root_path=None, middleware=[], model='/vllm/.idea/full_models/llama-70b', tokenizer=None, revision=None, code_revision=None, tokenizer_revision=None, tokenizer_mode='auto', trust_remote_code=False, download_dir=None, load_format='auto', dtype='auto', kv_cache_dtype='auto', max_model_len=None, worker_use_ray=False, pipeline_parallel_size=1, tensor_parallel_size=4, max_parallel_loading_workers=None, ray_workers_use_nsight=False, block_size=16, enable_prefix_caching=False, seed=0, swap_space=4, gpu_memory_utilization=0.95, max_num_batched_tokens=None, max_num_seqs=256, max_logprobs=5, disable_log_stats=False, quantization=None, enforce_eager=True, max_context_len_to_capture=8192, disable_custom_all_reduce=False, tokenizer_pool_size=0, tokenizer_pool_type='ray', tokenizer_pool_extra_config=None, enable_lora=False, max_loras=1, max_lora_rank=64, lora_extra_vocab_size=256, lora_dtype='auto', max_cpu_loras=32, enable_delta=True, max_deltas=2, max_cpu_deltas=32, max_delta_bitwidth=4, device='auto', image_input_type=None, image_token_id=None, image_input_shape=None, image_feature_size=None, scheduler_delay_factor=0.0, enable_prefetch=True, engine_use_ray=False, disable_log_requests=True, max_log_len=None)
2024-05-06 04:27:13,713	INFO worker.py:1749 -- Started a local Ray instance.
INFO 05-06 04:27:16 llm_engine.py:87] Initializing an LLM engine (v0.3.3) with config: model='/vllm/.idea/full_models/llama-70b', tokenizer='/vllm/.idea/full_models/llama-70b', tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=False, dtype=torch.float16, lora_config=None, delta_config=DeltaConfig(max_deltas=2, max_bitwidth=4, delta_dtype=torch.int8, max_cpu_deltas=32, delta_extra_vocab_size=0, pack_factor=Fraction(2, 1), kernel=<QuantKernel.TRITON: 'triton'>), max_seq_len=4096, download_dir=None, load_format=auto, tensor_parallel_size=4, disable_custom_all_reduce=False, quantization=None, enforce_eager=True, kv_cache_dtype=auto, device_config=cuda, seed=0)
INFO 05-06 04:27:16 llm_engine.py:237] ignored verifying delta_config
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fba9ab0>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fba9ab0>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fba91e0>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fba8070>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbaa380>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbaac50>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbab160>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbaa530>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fba8370>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fba9210>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fba9ae0>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbab520>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fba98d0>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fba9000>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fba8610>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbaa6e0>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbab130>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbab100>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbaa560>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fba83d0>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fba92a0>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fba9690>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbab1f0>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fba9450>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fba8b80>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbaa140>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbaaa10>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbaadd0>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fb7f910>: Failed to establish a new connection: [Errno 111] Connection refused'))
Using bitblas
WARNING 05-06 04:32:05 models.py:48] Using bitblas delta modules
INFO 05-06 04:32:05 selector.py:16] Using FlashAttention backend.
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbaaec0>: Failed to establish a new connection: [Errno 111] Connection refused'))
[36m(RayWorkerVllm pid=109100)[0m Exception ignored in: <function TempDirectory.__del__ at 0x7f4ee4914c10>
[36m(RayWorkerVllm pid=109100)[0m Traceback (most recent call last):
[36m(RayWorkerVllm pid=109100)[0m   File "/usr/local/lib/python3.10/dist-packages/bitblas/3rdparty/tvm/python/tvm/contrib/utils.py", line 145, in __del__
[36m(RayWorkerVllm pid=109100)[0m     self.remove()
[36m(RayWorkerVllm pid=109100)[0m   File "/usr/local/lib/python3.10/dist-packages/bitblas/3rdparty/tvm/python/tvm/contrib/utils.py", line 121, in remove
[36m(RayWorkerVllm pid=109100)[0m     if self.temp_dir:
[36m(RayWorkerVllm pid=109100)[0m AttributeError: 'TempDirectory' object has no attribute 'temp_dir'
[36m(RayWorkerVllm pid=109858)[0m Exception ignored in: <function TempDirectory.__del__ at 0x7f07ed1b8c10>
[36m(RayWorkerVllm pid=109858)[0m Traceback (most recent call last):
[36m(RayWorkerVllm pid=109858)[0m   File "/usr/local/lib/python3.10/dist-packages/bitblas/3rdparty/tvm/python/tvm/contrib/utils.py", line 145, in __del__
[36m(RayWorkerVllm pid=109858)[0m     self.remove()
[36m(RayWorkerVllm pid=109858)[0m   File "/usr/local/lib/python3.10/dist-packages/bitblas/3rdparty/tvm/python/tvm/contrib/utils.py", line 121, in remove
[36m(RayWorkerVllm pid=109858)[0m     if self.temp_dir:
[36m(RayWorkerVllm pid=109858)[0m AttributeError: 'TempDirectory' object has no attribute 'temp_dir'
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fba8430>: Failed to establish a new connection: [Errno 111] Connection refused'))
[36m(RayWorkerVllm pid=109100)[0m Exception ignored in: <function TempDirectory.__del__ at 0x7f4ee4914c10>
[36m(RayWorkerVllm pid=109100)[0m Traceback (most recent call last):
[36m(RayWorkerVllm pid=109100)[0m   File "/usr/local/lib/python3.10/dist-packages/bitblas/3rdparty/tvm/python/tvm/contrib/utils.py", line 145, in __del__
[36m(RayWorkerVllm pid=109100)[0m     self.remove()
[36m(RayWorkerVllm pid=109100)[0m   File "/usr/local/lib/python3.10/dist-packages/bitblas/3rdparty/tvm/python/tvm/contrib/utils.py", line 121, in remove
[36m(RayWorkerVllm pid=109100)[0m     if self.temp_dir:
[36m(RayWorkerVllm pid=109100)[0m AttributeError: 'TempDirectory' object has no attribute 'temp_dir'
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fba9090>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fba9960>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbab3a0>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fba8fa0>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fba8640>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbaa6b0>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbaae00>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbab0a0>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fb7ff40>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbab940>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbaa770>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fba82b0>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fba8eb0>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbabdf0>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbaa260>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fba82e0>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbaa650>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbab160>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbab700>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fba93f0>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbab5e0>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbab7f0>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbaa1a0>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fba83a0>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbabe20>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fba82b0>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbaab00>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbaba00>: Failed to establish a new connection: [Errno 111] Connection refused'))
[36m(RayWorkerVllm pid=109100)[0m Using bitblas
[36m(RayWorkerVllm pid=109515)[0m Using bitblas
[36m(RayWorkerVllm pid=109858)[0m Using bitblas
[36m(RayWorkerVllm pid=109100)[0m BitBLAS Operator not loaded, retrying in 5 seconds...
[36m(RayWorkerVllm pid=109100)[0m Error: [Errno 17] File exists: '/home/xiayao/.cache/bitblas/nvidia/nvidia-a100/c96df0f34eb23be516ef0126651d4e78b151337f28ebc87cc5492d79d135855f/tvm_rt_mod'
[36m(RayWorkerVllm pid=109858)[0m BitBLAS Operator not loaded, retrying in 5 seconds...
[36m(RayWorkerVllm pid=109858)[0m Error: [Errno 17] File exists: '/home/xiayao/.cache/bitblas/nvidia/nvidia-a100/c96df0f34eb23be516ef0126651d4e78b151337f28ebc87cc5492d79d135855f/tvm_rt_mod'
[36m(RayWorkerVllm pid=109100)[0m BitBLAS Operator not loaded, retrying in 5 seconds...
[36m(RayWorkerVllm pid=109100)[0m Error: [Errno 17] File exists: '/home/xiayao/.cache/bitblas/nvidia/nvidia-a100/c96df0f34eb23be516ef0126651d4e78b151337f28ebc87cc5492d79d135855f/tvm_rt_mod'
[36m(RayWorkerVllm pid=109515)[0m WARNING 05-06 04:36:21 models.py:48] Using bitblas delta modules
[36m(RayWorkerVllm pid=109515)[0m INFO 05-06 04:36:21 selector.py:16] Using FlashAttention backend.
[36m(RayWorkerVllm pid=109858)[0m WARNING 05-06 04:36:24 models.py:48] Using bitblas delta modules
[36m(RayWorkerVllm pid=109858)[0m INFO 05-06 04:36:24 selector.py:16] Using FlashAttention backend.
[36m(RayWorkerVllm pid=109100)[0m WARNING 05-06 04:36:31 models.py:48] Using bitblas delta modules
[36m(RayWorkerVllm pid=109100)[0m INFO 05-06 04:36:31 selector.py:16] Using FlashAttention backend.
INFO 05-06 04:36:59 model_runner.py:155] Loading model weights took 32.1245 GB
INFO 05-06 04:36:59 worker_manager.py:293] Starting prefetching thread
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbab5b0>: Failed to establish a new connection: [Errno 111] Connection refused'))
[36m(RayWorkerVllm pid=109858)[0m INFO 05-06 04:37:08 model_runner.py:155] Loading model weights took 32.1245 GB
[36m(RayWorkerVllm pid=109858)[0m INFO 05-06 04:37:08 worker_manager.py:293] Starting prefetching thread
[36m(RayWorkerVllm pid=109515)[0m INFO 05-06 04:37:08 model_runner.py:155] Loading model weights took 32.1245 GB
[36m(RayWorkerVllm pid=109515)[0m INFO 05-06 04:37:08 worker_manager.py:293] Starting prefetching thread
[36m(RayWorkerVllm pid=109100)[0m INFO 05-06 04:37:08 model_runner.py:155] Loading model weights took 32.1245 GB
[36m(RayWorkerVllm pid=109100)[0m INFO 05-06 04:37:08 worker_manager.py:293] Starting prefetching thread
WARNING 05-06 04:37:14 quant_linear_triton.py:557] We should warm up the kernel here 
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fb7fac0>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fba9ae0>: Failed to establish a new connection: [Errno 111] Connection refused'))
Waiting for 10 secs for the system to be ready: HTTPConnectionPool(host='localhost', port=8000): Max retries exceeded with url: /sysinfo (Caused by NewConnectionError('<urllib3.connection.HTTPConnection object at 0x7fc76fbabb50>: Failed to establish a new connection: [Errno 111] Connection refused'))
[36m(RayWorkerVllm pid=109858)[0m WARNING 05-06 04:37:22 quant_linear_triton.py:557] We should warm up the kernel here 
[36m(RayWorkerVllm pid=109515)[0m WARNING 05-06 04:37:22 quant_linear_triton.py:557] We should warm up the kernel here 
[36m(RayWorkerVllm pid=109100)[0m WARNING 05-06 04:37:22 quant_linear_triton.py:557] We should warm up the kernel here 
INFO 05-06 04:37:39 ray_gpu_executor.py:266] # GPU blocks: 19559, # CPU blocks: 3276
INFO 05-06 04:37:45 block_manager.py:264] disable automatic prefix caching
WARNING 05-06 04:37:45 serving_chat.py:373] No chat template provided. Chat API will not work.
INFO:     Started server process [99271]
INFO:     Waiting for application startup.
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8000 (Press CTRL+C to quit)
INFO:     ::1:37380 - "GET /sysinfo HTTP/1.1" 200 OK
Translating from base-model to /vllm/.idea/full_models/llama-70b
Warming up starts
{'id': 21, 'prompt': 'USER: what do you think about the future of iran?\nASSISTANT:', 'timestamp': 0, 'model': 'delta-3', 'min_tokens': 184, 'max_tokens': 184}
INFO 05-06 04:37:48 worker_manager.py:325] Adding delta 3 to prefetching queue: [3]
WARNING 05-06 04:37:48 worker_manager.py:335] Missed prefetch, fall back to loading delta 3 now
INFO 05-06 04:37:48 models.py:214] Loading from ['bitblas.remain.safetensors', 'bitblas.rank.0.safetensors']
INFO 05-06 04:37:48 models.py:268] [main] Lossless Compression Disabled
[36m(RayWorkerVllm pid=109100)[0m INFO 05-06 04:37:48 worker_manager.py:325] Adding delta 3 to prefetching queue: [3]
[36m(RayWorkerVllm pid=109100)[0m WARNING 05-06 04:37:48 worker_manager.py:335] Missed prefetch, fall back to loading delta 3 now
[36m(RayWorkerVllm pid=109100)[0m INFO 05-06 04:37:48 models.py:214] Loading from ['bitblas.remain.safetensors', 'bitblas.rank.1.safetensors']
[36m(RayWorkerVllm pid=109100)[0m INFO 05-06 04:37:48 models.py:268] [main] Lossless Compression Disabled
[36m(RayWorkerVllm pid=109515)[0m INFO 05-06 04:37:48 worker_manager.py:325] Adding delta 3 to prefetching queue: [3]
[36m(RayWorkerVllm pid=109515)[0m WARNING 05-06 04:37:48 worker_manager.py:335] Missed prefetch, fall back to loading delta 3 now
[36m(RayWorkerVllm pid=109515)[0m INFO 05-06 04:37:48 models.py:214] Loading from ['bitblas.remain.safetensors', 'bitblas.rank.2.safetensors']
[36m(RayWorkerVllm pid=109515)[0m INFO 05-06 04:37:48 models.py:268] [main] Lossless Compression Disabled
[36m(RayWorkerVllm pid=109858)[0m INFO 05-06 04:37:48 worker_manager.py:325] Adding delta 3 to prefetching queue: [3]
[36m(RayWorkerVllm pid=109858)[0m WARNING 05-06 04:37:48 worker_manager.py:335] Missed prefetch, fall back to loading delta 3 now
[36m(RayWorkerVllm pid=109858)[0m INFO 05-06 04:37:48 models.py:214] Loading from ['bitblas.remain.safetensors', 'bitblas.rank.3.safetensors']
[36m(RayWorkerVllm pid=109858)[0m INFO 05-06 04:37:48 models.py:268] [main] Lossless Compression Disabled
INFO 05-06 04:37:55 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 0.0 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.0%, CPU KV cache usage: 0.0%
INFO 05-06 04:38:05 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 0.0 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.0%, CPU KV cache usage: 0.0%
INFO 05-06 04:38:15 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 0.0 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.0%, CPU KV cache usage: 0.0%
INFO 05-06 04:38:25 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 0.0 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.0%, CPU KV cache usage: 0.0%
INFO 05-06 04:38:35 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 0.0 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.0%, CPU KV cache usage: 0.0%
INFO 05-06 04:38:45 models.py:324] Disk -> CPU: Loaded 8428.53 MiB in 56.735 seconds
INFO 05-06 04:38:45 worker_manager.py:353] Main thread loading delta 3 done
INFO 05-06 04:38:45 worker_manager.py:368] [1714941525.7415733] activating delta
INFO 05-06 04:38:45 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 0.0 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.0%, CPU KV cache usage: 0.0%
INFO 05-06 04:38:46 worker_manager.py:373] [1714941526.1916542] CPU -> GPU time: 0.4486
INFO 05-06 04:39:51 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 0.0 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.0%, CPU KV cache usage: 0.0%
[36m(RayWorkerVllm pid=109515)[0m INFO 05-06 04:39:38 models.py:324] Disk -> CPU: Loaded 8428.53 MiB in 110.124 seconds
[36m(RayWorkerVllm pid=109515)[0m INFO 05-06 04:39:39 worker_manager.py:353] Main thread loading delta 3 done
[36m(RayWorkerVllm pid=109515)[0m INFO 05-06 04:39:39 worker_manager.py:368] [1714941579.0843985] activating delta
[36m(RayWorkerVllm pid=109515)[0m INFO 05-06 04:39:39 worker_manager.py:373] [1714941579.5467477] CPU -> GPU time: 0.4623
[36m(RayWorkerVllm pid=109858)[0m INFO 05-06 04:39:42 models.py:324] Disk -> CPU: Loaded 8428.53 MiB in 113.763 seconds
[36m(RayWorkerVllm pid=109858)[0m INFO 05-06 04:39:42 worker_manager.py:353] Main thread loading delta 3 done
[36m(RayWorkerVllm pid=109858)[0m INFO 05-06 04:39:42 worker_manager.py:368] [1714941582.7904053] activating delta
[36m(RayWorkerVllm pid=109858)[0m INFO 05-06 04:39:43 worker_manager.py:373] [1714941583.256752] CPU -> GPU time: 0.4663
[36m(RayWorkerVllm pid=109100)[0m INFO 05-06 04:39:50 models.py:324] Disk -> CPU: Loaded 8428.53 MiB in 121.698 seconds
[36m(RayWorkerVllm pid=109100)[0m INFO 05-06 04:39:50 worker_manager.py:353] Main thread loading delta 3 done
[36m(RayWorkerVllm pid=109100)[0m INFO 05-06 04:39:50 worker_manager.py:368] [1714941590.6412451] activating delta
[36m(RayWorkerVllm pid=109100)[0m INFO 05-06 04:39:51 worker_manager.py:373] [1714941591.1046114] CPU -> GPU time: 0.4633
INFO 05-06 04:39:56 metrics.py:276] Avg prompt throughput: 3.7 tokens/s, Avg generation throughput: 0.9 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.0%, CPU KV cache usage: 0.0%
INFO 05-06 04:40:01 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 2.1 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.0%, CPU KV cache usage: 0.0%
INFO 05-06 04:40:06 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 2.1 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.0%, CPU KV cache usage: 0.0%
INFO 05-06 04:40:12 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 2.1 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.0%, CPU KV cache usage: 0.0%
INFO 05-06 04:40:17 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 2.1 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.0%, CPU KV cache usage: 0.0%
INFO 05-06 04:40:22 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 2.1 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.0%, CPU KV cache usage: 0.0%
INFO 05-06 04:40:28 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 2.1 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.0%, CPU KV cache usage: 0.0%
INFO 05-06 04:40:33 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 2.1 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.0%, CPU KV cache usage: 0.0%
INFO 05-06 04:40:38 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 2.1 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.0%, CPU KV cache usage: 0.0%
INFO 05-06 04:40:44 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 2.1 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.0%, CPU KV cache usage: 0.0%
INFO 05-06 04:40:49 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 2.1 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.0%, CPU KV cache usage: 0.0%
INFO 05-06 04:40:54 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 2.1 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.1%, CPU KV cache usage: 0.0%
INFO 05-06 04:40:59 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 2.1 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.1%, CPU KV cache usage: 0.0%
INFO 05-06 04:41:04 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 2.1 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.1%, CPU KV cache usage: 0.0%
INFO 05-06 04:41:10 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 2.1 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.1%, CPU KV cache usage: 0.0%
INFO 05-06 04:41:15 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 2.1 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.1%, CPU KV cache usage: 0.0%
INFO 05-06 04:41:20 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 2.1 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.1%, CPU KV cache usage: 0.0%
INFO:     ::1:37382 - "POST /v1/completions HTTP/1.1" 200 OK
Warming up ends
Issuing queries
sending 1 queries at 1.6
sending 1 queries at 4.2
sending 1 queries at 6.0
sending 1 queries at 7.6000000000000005
sending 1 queries at 8.700000000000001
sending 1 queries at 10.8
sending 1 queries at 11.9
sending 1 queries at 16.400000000000002
sending 1 queries at 23.0
sending 1 queries at 23.900000000000002
sending 1 queries at 27.1
sending 1 queries at 28.6
sending 1 queries at 30.3
sending 1 queries at 35.5
sending 1 queries at 35.6
sending 2 queries at 35.800000000000004
sending 1 queries at 39.400000000000006
sending 1 queries at 42.400000000000006
sending 1 queries at 46.5
sending 1 queries at 54.2
sending 1 queries at 57.400000000000006
sending 1 queries at 58.6
INFO 05-06 04:41:23 worker_manager.py:325] Adding delta 6 to prefetching queue: [6]
WARNING 05-06 04:41:23 worker_manager.py:335] Missed prefetch, fall back to loading delta 6 now
INFO 05-06 04:41:23 models.py:214] Loading from ['bitblas.remain.safetensors', 'bitblas.rank.0.safetensors']
INFO 05-06 04:41:23 models.py:268] [main] Lossless Compression Disabled
[36m(RayWorkerVllm pid=109100)[0m INFO 05-06 04:41:23 worker_manager.py:325] Adding delta 6 to prefetching queue: [6]
[36m(RayWorkerVllm pid=109100)[0m WARNING 05-06 04:41:23 worker_manager.py:335] Missed prefetch, fall back to loading delta 6 now
[36m(RayWorkerVllm pid=109100)[0m INFO 05-06 04:41:23 models.py:214] Loading from ['bitblas.remain.safetensors', 'bitblas.rank.1.safetensors']
[36m(RayWorkerVllm pid=109100)[0m INFO 05-06 04:41:23 models.py:268] [main] Lossless Compression Disabled
[36m(RayWorkerVllm pid=109515)[0m INFO 05-06 04:41:23 worker_manager.py:325] Adding delta 6 to prefetching queue: [6]
[36m(RayWorkerVllm pid=109515)[0m WARNING 05-06 04:41:23 worker_manager.py:335] Missed prefetch, fall back to loading delta 6 now
[36m(RayWorkerVllm pid=109515)[0m INFO 05-06 04:41:23 models.py:214] Loading from ['bitblas.remain.safetensors', 'bitblas.rank.2.safetensors']
[36m(RayWorkerVllm pid=109515)[0m INFO 05-06 04:41:23 models.py:268] [main] Lossless Compression Disabled
[36m(RayWorkerVllm pid=109858)[0m INFO 05-06 04:41:23 worker_manager.py:325] Adding delta 6 to prefetching queue: [6]
[36m(RayWorkerVllm pid=109858)[0m WARNING 05-06 04:41:23 worker_manager.py:335] Missed prefetch, fall back to loading delta 6 now
[36m(RayWorkerVllm pid=109858)[0m INFO 05-06 04:41:23 models.py:214] Loading from ['bitblas.remain.safetensors', 'bitblas.rank.3.safetensors']
[36m(RayWorkerVllm pid=109858)[0m INFO 05-06 04:41:23 models.py:268] [main] Lossless Compression Disabled
INFO 05-06 04:41:26 worker_manager.py:325] Adding delta 8 to prefetching queue: [8]
total threads: 23
INFO 05-06 04:42:25 models.py:324] Disk -> CPU: Loaded 8428.53 MiB in 62.002 seconds
INFO 05-06 04:42:25 worker_manager.py:353] Main thread loading delta 6 done
INFO 05-06 04:42:26 models.py:214] Loading from ['bitblas.remain.safetensors', 'bitblas.rank.0.safetensors']
INFO 05-06 04:42:26 models.py:268] [prefetching] Lossless Compression Disabled
[36m(RayWorkerVllm pid=109100)[0m INFO 05-06 04:43:30 models.py:324] Disk -> CPU: Loaded 8428.53 MiB in 126.717 seconds
[36m(RayWorkerVllm pid=109100)[0m INFO 05-06 04:43:30 worker_manager.py:353] Main thread loading delta 6 done
[36m(RayWorkerVllm pid=109515)[0m INFO 05-06 04:43:32 models.py:324] Disk -> CPU: Loaded 8428.53 MiB in 129.084 seconds
[36m(RayWorkerVllm pid=109515)[0m INFO 05-06 04:43:33 worker_manager.py:353] Main thread loading delta 6 done
[36m(RayWorkerVllm pid=109858)[0m INFO 05-06 04:43:50 models.py:324] Disk -> CPU: Loaded 8428.53 MiB in 146.681 seconds
[36m(RayWorkerVllm pid=109858)[0m INFO 05-06 04:43:50 worker_manager.py:353] Main thread loading delta 6 done
INFO 05-06 04:43:55 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 0.0 tokens/s, Running: 1 reqs, Swapped: 0 reqs, Pending: 0 reqs, GPU KV cache usage: 0.0%, CPU KV cache usage: 0.0%
INFO 05-06 04:43:55 worker_manager.py:325] Adding delta 4 to prefetching queue: [8, 4]
INFO 05-06 04:43:55 worker_manager.py:325] Adding delta 1 to prefetching queue: [8, 4, 1]
WARNING 05-06 04:43:55 worker_manager.py:335] Missed prefetch, fall back to loading delta 8 now
WARNING 05-06 04:43:55 worker_manager.py:344] Discarding prefetching delta 8
INFO 05-06 04:43:55 models.py:214] Loading from ['bitblas.remain.safetensors', 'bitblas.rank.0.safetensors']
INFO 05-06 04:43:55 models.py:268] [main] Lossless Compression Disabled
[36m(RayWorkerVllm pid=109100)[0m INFO 05-06 04:43:55 worker_manager.py:325] Adding delta 8 to prefetching queue: [8]
[36m(RayWorkerVllm pid=109100)[0m INFO 05-06 04:43:55 worker_manager.py:325] Adding delta 4 to prefetching queue: [8, 4]
[36m(RayWorkerVllm pid=109100)[0m INFO 05-06 04:43:55 worker_manager.py:325] Adding delta 1 to prefetching queue: [8, 4, 1]
[36m(RayWorkerVllm pid=109100)[0m WARNING 05-06 04:43:55 worker_manager.py:335] Missed prefetch, fall back to loading delta 8 now
[36m(RayWorkerVllm pid=109100)[0m INFO 05-06 04:43:55 models.py:214] Loading from ['bitblas.remain.safetensors', 'bitblas.rank.1.safetensors']
[36m(RayWorkerVllm pid=109100)[0m INFO 05-06 04:43:55 models.py:268] [main] Lossless Compression Disabled
[36m(RayWorkerVllm pid=109515)[0m INFO 05-06 04:43:55 worker_manager.py:325] Adding delta 8 to prefetching queue: [8]
[36m(RayWorkerVllm pid=109515)[0m INFO 05-06 04:43:55 worker_manager.py:325] Adding delta 4 to prefetching queue: [8, 4]
[36m(RayWorkerVllm pid=109515)[0m INFO 05-06 04:43:55 worker_manager.py:325] Adding delta 1 to prefetching queue: [8, 4, 1]
[36m(RayWorkerVllm pid=109515)[0m WARNING 05-06 04:43:55 worker_manager.py:335] Missed prefetch, fall back to loading delta 8 now
[36m(RayWorkerVllm pid=109515)[0m INFO 05-06 04:43:55 models.py:214] Loading from ['bitblas.remain.safetensors', 'bitblas.rank.2.safetensors']
[36m(RayWorkerVllm pid=109515)[0m INFO 05-06 04:43:55 models.py:268] [main] Lossless Compression Disabled
[36m(RayWorkerVllm pid=109858)[0m INFO 05-06 04:43:55 worker_manager.py:325] Adding delta 8 to prefetching queue: [8]
[36m(RayWorkerVllm pid=109858)[0m INFO 05-06 04:43:55 worker_manager.py:325] Adding delta 4 to prefetching queue: [8, 4]
[36m(RayWorkerVllm pid=109858)[0m INFO 05-06 04:43:55 worker_manager.py:325] Adding delta 1 to prefetching queue: [8, 4, 1]
[36m(RayWorkerVllm pid=109858)[0m WARNING 05-06 04:43:55 worker_manager.py:335] Missed prefetch, fall back to loading delta 8 now
[36m(RayWorkerVllm pid=109858)[0m INFO 05-06 04:43:55 models.py:214] Loading from ['bitblas.remain.safetensors', 'bitblas.rank.3.safetensors']
[36m(RayWorkerVllm pid=109858)[0m INFO 05-06 04:43:55 models.py:268] [main] Lossless Compression Disabled
INFO 05-06 04:44:50 models.py:324] Disk -> CPU: Loaded 8428.53 MiB in 54.983 seconds
INFO 05-06 04:44:50 models.py:324] Disk -> CPU: Loaded 8428.53 MiB in 144.946 seconds
INFO 05-06 04:44:51 worker_manager.py:353] Main thread loading delta 8 done
INFO 05-06 04:44:52 worker_manager.py:278] Prefetching delta 8 done
[36m(RayWorkerVllm pid=109515)[0m INFO 05-06 04:45:38 models.py:324] Disk -> CPU: Loaded 8428.53 MiB in 102.772 seconds
[36m(RayWorkerVllm pid=109515)[0m INFO 05-06 04:45:39 worker_manager.py:353] Main thread loading delta 8 done
[36m(RayWorkerVllm pid=109515)[0m INFO 05-06 04:45:39 models.py:214] Loading from ['bitblas.remain.safetensors', 'bitblas.rank.2.safetensors']
[36m(RayWorkerVllm pid=109515)[0m INFO 05-06 04:45:39 models.py:268] [prefetching] Lossless Compression Disabled
[36m(RayWorkerVllm pid=109858)[0m INFO 05-06 04:46:11 models.py:324] Disk -> CPU: Loaded 8428.53 MiB in 135.677 seconds
[36m(RayWorkerVllm pid=109858)[0m INFO 05-06 04:46:12 worker_manager.py:353] Main thread loading delta 8 done
[36m(RayWorkerVllm pid=109858)[0m INFO 05-06 04:46:12 models.py:214] Loading from ['bitblas.remain.safetensors', 'bitblas.rank.3.safetensors']
[36m(RayWorkerVllm pid=109858)[0m INFO 05-06 04:46:12 models.py:268] [prefetching] Lossless Compression Disabled
[36m(RayWorkerVllm pid=109100)[0m INFO 05-06 04:46:14 models.py:324] Disk -> CPU: Loaded 8428.53 MiB in 138.699 seconds
[36m(RayWorkerVllm pid=109100)[0m INFO 05-06 04:46:15 worker_manager.py:353] Main thread loading delta 8 done
[36m(RayWorkerVllm pid=109100)[0m INFO 05-06 04:46:15 models.py:214] Loading from ['bitblas.remain.safetensors', 'bitblas.rank.1.safetensors']
[36m(RayWorkerVllm pid=109100)[0m INFO 05-06 04:46:15 models.py:268] [prefetching] Lossless Compression Disabled
INFO 05-06 04:46:16 models.py:214] Loading from ['bitblas.remain.safetensors', 'bitblas.rank.0.safetensors']
INFO 05-06 04:46:16 models.py:268] [prefetching] Lossless Compression Disabled
INFO 05-06 04:46:26 worker_manager.py:325] Adding delta 7 to prefetching queue: [4, 1, 7]
INFO 05-06 04:46:26 metrics.py:276] Avg prompt throughput: 0.1 tokens/s, Avg generation throughput: 0.0 tokens/s, Running: 3 reqs, Swapped: 0 reqs, Pending: 4 reqs, GPU KV cache usage: 0.0%, CPU KV cache usage: 0.0%
INFO 05-06 04:46:26 worker_manager.py:325] Adding delta 2 to prefetching queue: [4, 1, 7, 2]
INFO 05-06 04:46:26 worker_manager.py:325] Adding delta 5 to prefetching queue: [4, 1, 7, 2, 5]
[36m(RayWorkerVllm pid=109100)[0m INFO 05-06 04:46:26 worker_manager.py:325] Adding delta 7 to prefetching queue: [4, 1, 7]
[36m(RayWorkerVllm pid=109100)[0m INFO 05-06 04:46:26 worker_manager.py:325] Adding delta 2 to prefetching queue: [4, 1, 7, 2]
[36m(RayWorkerVllm pid=109100)[0m INFO 05-06 04:46:26 worker_manager.py:325] Adding delta 5 to prefetching queue: [4, 1, 7, 2, 5]
[36m(RayWorkerVllm pid=109515)[0m INFO 05-06 04:46:26 worker_manager.py:325] Adding delta 7 to prefetching queue: [4, 1, 7]
[36m(RayWorkerVllm pid=109515)[0m INFO 05-06 04:46:26 worker_manager.py:325] Adding delta 2 to prefetching queue: [4, 1, 7, 2]
[36m(RayWorkerVllm pid=109515)[0m INFO 05-06 04:46:26 worker_manager.py:325] Adding delta 5 to prefetching queue: [4, 1, 7, 2, 5]
[36m(RayWorkerVllm pid=109858)[0m INFO 05-06 04:46:26 worker_manager.py:325] Adding delta 7 to prefetching queue: [4, 1, 7]
[36m(RayWorkerVllm pid=109858)[0m INFO 05-06 04:46:26 worker_manager.py:325] Adding delta 2 to prefetching queue: [4, 1, 7, 2]
[36m(RayWorkerVllm pid=109858)[0m INFO 05-06 04:46:26 worker_manager.py:325] Adding delta 5 to prefetching queue: [4, 1, 7, 2, 5]
INFO 05-06 04:46:31 metrics.py:276] Avg prompt throughput: 16.3 tokens/s, Avg generation throughput: 0.8 tokens/s, Running: 5 reqs, Swapped: 0 reqs, Pending: 11 reqs, GPU KV cache usage: 0.1%, CPU KV cache usage: 0.0%
INFO 05-06 04:46:43 metrics.py:276] Avg prompt throughput: 4.5 tokens/s, Avg generation throughput: 0.1 tokens/s, Running: 6 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.1%, CPU KV cache usage: 0.0%
INFO 05-06 04:46:48 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 3.4 tokens/s, Running: 6 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.1%, CPU KV cache usage: 0.0%
INFO 05-06 04:46:55 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 3.8 tokens/s, Running: 6 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.1%, CPU KV cache usage: 0.0%
INFO 05-06 04:47:00 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 3.6 tokens/s, Running: 6 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.1%, CPU KV cache usage: 0.0%
INFO 05-06 04:47:06 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 3.9 tokens/s, Running: 6 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.1%, CPU KV cache usage: 0.0%
INFO 05-06 04:47:12 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 3.9 tokens/s, Running: 6 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.1%, CPU KV cache usage: 0.0%
INFO 05-06 04:47:18 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 4.0 tokens/s, Running: 6 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.1%, CPU KV cache usage: 0.0%
INFO 05-06 04:47:18 models.py:324] Disk -> CPU: Loaded 8428.53 MiB in 62.045 seconds
INFO 05-06 04:47:18 worker_manager.py:278] Prefetching delta 4 done
INFO 05-06 04:47:18 models.py:214] Loading from ['bitblas.remain.safetensors', 'bitblas.rank.0.safetensors']
INFO 05-06 04:47:18 models.py:268] [prefetching] Lossless Compression Disabled
INFO 05-06 04:47:23 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 3.5 tokens/s, Running: 6 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.1%, CPU KV cache usage: 0.0%
INFO 05-06 04:47:29 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 5.3 tokens/s, Running: 6 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.1%, CPU KV cache usage: 0.0%
INFO 05-06 04:47:35 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 5.1 tokens/s, Running: 6 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.1%, CPU KV cache usage: 0.0%
INFO 05-06 04:47:40 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 4.6 tokens/s, Running: 6 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.1%, CPU KV cache usage: 0.0%
INFO 05-06 04:47:46 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 5.0 tokens/s, Running: 6 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.2%, CPU KV cache usage: 0.0%
INFO 05-06 04:47:47 models.py:324] Disk -> CPU: Loaded 8428.53 MiB in 28.117 seconds
INFO 05-06 04:47:47 worker_manager.py:278] Prefetching delta 1 done
INFO 05-06 04:47:48 models.py:214] Loading from ['bitblas.remain.safetensors', 'bitblas.rank.0.safetensors']
INFO 05-06 04:47:48 models.py:268] [prefetching] Lossless Compression Disabled
INFO 05-06 04:47:52 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 3.0 tokens/s, Running: 6 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.2%, CPU KV cache usage: 0.0%
INFO 05-06 04:47:59 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 3.6 tokens/s, Running: 6 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.2%, CPU KV cache usage: 0.0%
INFO 05-06 04:48:05 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 3.8 tokens/s, Running: 6 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.2%, CPU KV cache usage: 0.0%
INFO 05-06 04:48:11 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 3.9 tokens/s, Running: 6 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.2%, CPU KV cache usage: 0.0%
[36m(RayWorkerVllm pid=109858)[0m INFO 05-06 04:48:13 models.py:324] Disk -> CPU: Loaded 8428.53 MiB in 121.861 seconds
[36m(RayWorkerVllm pid=109858)[0m INFO 05-06 04:48:14 worker_manager.py:278] Prefetching delta 4 done
[36m(RayWorkerVllm pid=109858)[0m INFO 05-06 04:48:14 models.py:214] Loading from ['bitblas.remain.safetensors', 'bitblas.rank.3.safetensors']
[36m(RayWorkerVllm pid=109858)[0m INFO 05-06 04:48:14 models.py:268] [prefetching] Lossless Compression Disabled
INFO 05-06 04:48:17 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 2.2 tokens/s, Running: 6 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.2%, CPU KV cache usage: 0.0%
INFO 05-06 04:48:22 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 4.2 tokens/s, Running: 6 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.2%, CPU KV cache usage: 0.0%
INFO:     ::1:37990 - "POST /v1/completions HTTP/1.1" 200 OK
INFO 05-06 04:48:28 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 3.7 tokens/s, Running: 5 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.2%, CPU KV cache usage: 0.0%
[36m(RayWorkerVllm pid=109515)[0m INFO 05-06 04:48:33 models.py:324] Disk -> CPU: Loaded 8428.53 MiB in 174.132 seconds
INFO 05-06 04:48:33 models.py:324] Disk -> CPU: Loaded 8428.53 MiB in 45.149 seconds
[36m(RayWorkerVllm pid=109515)[0m INFO 05-06 04:48:33 worker_manager.py:278] Prefetching delta 4 done
[36m(RayWorkerVllm pid=109515)[0m INFO 05-06 04:48:33 models.py:214] Loading from ['bitblas.remain.safetensors', 'bitblas.rank.2.safetensors']
[36m(RayWorkerVllm pid=109515)[0m INFO 05-06 04:48:33 models.py:268] [prefetching] Lossless Compression Disabled
INFO 05-06 04:48:33 worker_manager.py:278] Prefetching delta 7 done
INFO 05-06 04:48:33 models.py:214] Loading from ['bitblas.remain.safetensors', 'bitblas.rank.0.safetensors']
INFO 05-06 04:48:33 models.py:268] [prefetching] Lossless Compression Disabled
INFO 05-06 04:48:37 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 1.7 tokens/s, Running: 5 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.2%, CPU KV cache usage: 0.0%
INFO 05-06 04:48:42 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 4.4 tokens/s, Running: 5 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.2%, CPU KV cache usage: 0.0%
INFO 05-06 04:48:48 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 3.7 tokens/s, Running: 5 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.2%, CPU KV cache usage: 0.0%
INFO 05-06 04:48:53 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 3.8 tokens/s, Running: 5 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.2%, CPU KV cache usage: 0.0%
[36m(RayWorkerVllm pid=109100)[0m INFO 05-06 04:48:56 models.py:324] Disk -> CPU: Loaded 8428.53 MiB in 161.905 seconds
[36m(RayWorkerVllm pid=109100)[0m INFO 05-06 04:48:57 worker_manager.py:278] Prefetching delta 4 done
[36m(RayWorkerVllm pid=109100)[0m INFO 05-06 04:48:57 models.py:214] Loading from ['bitblas.remain.safetensors', 'bitblas.rank.1.safetensors']
[36m(RayWorkerVllm pid=109100)[0m INFO 05-06 04:48:57 models.py:268] [prefetching] Lossless Compression Disabled
INFO 05-06 04:48:59 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 3.1 tokens/s, Running: 5 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.2%, CPU KV cache usage: 0.0%
INFO 05-06 04:49:05 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 3.6 tokens/s, Running: 5 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.2%, CPU KV cache usage: 0.0%
INFO 05-06 04:49:10 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 3.9 tokens/s, Running: 5 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.2%, CPU KV cache usage: 0.0%
INFO:     ::1:38088 - "POST /v1/completions HTTP/1.1" 200 OK
INFO 05-06 04:49:15 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 3.6 tokens/s, Running: 4 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.2%, CPU KV cache usage: 0.0%
INFO:     ::1:38046 - "POST /v1/completions HTTP/1.1" 200 OK
INFO 05-06 04:49:22 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 2.9 tokens/s, Running: 3 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.1%, CPU KV cache usage: 0.0%
INFO 05-06 04:49:27 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 2.3 tokens/s, Running: 3 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.1%, CPU KV cache usage: 0.0%
INFO 05-06 04:49:28 models.py:324] Disk -> CPU: Loaded 8428.53 MiB in 54.370 seconds
INFO 05-06 04:49:28 worker_manager.py:278] Prefetching delta 2 done
INFO 05-06 04:49:28 models.py:214] Loading from ['bitblas.remain.safetensors', 'bitblas.rank.0.safetensors']
INFO 05-06 04:49:28 models.py:268] [prefetching] Lossless Compression Disabled
INFO 05-06 04:49:32 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 2.2 tokens/s, Running: 2 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.1%, CPU KV cache usage: 0.0%
INFO:     ::1:38024 - "POST /v1/completions HTTP/1.1" 200 OK
INFO 05-06 04:49:38 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 2.2 tokens/s, Running: 2 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.1%, CPU KV cache usage: 0.0%
INFO 05-06 04:49:43 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 2.2 tokens/s, Running: 2 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.1%, CPU KV cache usage: 0.0%
INFO 05-06 04:49:49 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 1.8 tokens/s, Running: 2 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.1%, CPU KV cache usage: 0.0%
INFO 05-06 04:49:54 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 2.0 tokens/s, Running: 2 reqs, Swapped: 0 reqs, Pending: 17 reqs, GPU KV cache usage: 0.1%, CPU KV cache usage: 0.0%
INFO:     ::1:37976 - "POST /v1/completions HTTP/1.1" 200 OK
ERROR 05-06 04:49:57 async_llm_engine.py:57] Engine background task failed
ERROR 05-06 04:49:57 async_llm_engine.py:57] Traceback (most recent call last):
ERROR 05-06 04:49:57 async_llm_engine.py:57]   File "/vllm/vllm/engine/async_llm_engine.py", line 52, in _raise_exception_on_finish
ERROR 05-06 04:49:57 async_llm_engine.py:57]     task.result()
ERROR 05-06 04:49:57 async_llm_engine.py:57]   File "/vllm/vllm/engine/async_llm_engine.py", line 531, in run_engine_loop
ERROR 05-06 04:49:57 async_llm_engine.py:57]     has_requests_in_progress = await asyncio.wait_for(
ERROR 05-06 04:49:57 async_llm_engine.py:57]   File "/usr/lib/python3.10/asyncio/tasks.py", line 445, in wait_for
ERROR 05-06 04:49:57 async_llm_engine.py:57]     return fut.result()
ERROR 05-06 04:49:57 async_llm_engine.py:57]   File "/vllm/vllm/engine/async_llm_engine.py", line 504, in engine_step
ERROR 05-06 04:49:57 async_llm_engine.py:57]     request_outputs = await self.engine.step_async()
ERROR 05-06 04:49:57 async_llm_engine.py:57]   File "/vllm/vllm/engine/async_llm_engine.py", line 224, in step_async
ERROR 05-06 04:49:57 async_llm_engine.py:57]     output = await self.model_executor.execute_model_async(
ERROR 05-06 04:49:57 async_llm_engine.py:57]   File "/vllm/vllm/executor/ray_gpu_executor.py", line 487, in execute_model_async
ERROR 05-06 04:49:57 async_llm_engine.py:57]     all_outputs = await self._run_workers_async(
ERROR 05-06 04:49:57 async_llm_engine.py:57]   File "/vllm/vllm/executor/ray_gpu_executor.py", line 476, in _run_workers_async
ERROR 05-06 04:49:57 async_llm_engine.py:57]     all_outputs = await asyncio.gather(*coros)
ERROR 05-06 04:49:57 async_llm_engine.py:57]   File "/usr/lib/python3.10/concurrent/futures/thread.py", line 58, in run
ERROR 05-06 04:49:57 async_llm_engine.py:57]     result = self.fn(*self.args, **self.kwargs)
ERROR 05-06 04:49:57 async_llm_engine.py:57]   File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
ERROR 05-06 04:49:57 async_llm_engine.py:57]     return func(*args, **kwargs)
ERROR 05-06 04:49:57 async_llm_engine.py:57]   File "/vllm/vllm/worker/worker.py", line 249, in execute_model
ERROR 05-06 04:49:57 async_llm_engine.py:57]     output = self.model_runner.execute_model(
ERROR 05-06 04:49:57 async_llm_engine.py:57]   File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
ERROR 05-06 04:49:57 async_llm_engine.py:57]     return func(*args, **kwargs)
ERROR 05-06 04:49:57 async_llm_engine.py:57]   File "/vllm/vllm/worker/model_runner.py", line 861, in execute_model
ERROR 05-06 04:49:57 async_llm_engine.py:57]     hidden_states = model_executable(**execute_model_kwargs)
ERROR 05-06 04:49:57 async_llm_engine.py:57]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
ERROR 05-06 04:49:57 async_llm_engine.py:57]     return self._call_impl(*args, **kwargs)
ERROR 05-06 04:49:57 async_llm_engine.py:57]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
ERROR 05-06 04:49:57 async_llm_engine.py:57]     return forward_call(*args, **kwargs)
ERROR 05-06 04:49:57 async_llm_engine.py:57]   File "/vllm/vllm/model_executor/models/llama.py", line 373, in forward
ERROR 05-06 04:49:57 async_llm_engine.py:57]     hidden_states = self.model(input_ids, positions, kv_caches, attn_metadata)
ERROR 05-06 04:49:57 async_llm_engine.py:57]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
ERROR 05-06 04:49:57 async_llm_engine.py:57]     return self._call_impl(*args, **kwargs)
ERROR 05-06 04:49:57 async_llm_engine.py:57]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
ERROR 05-06 04:49:57 async_llm_engine.py:57]     return forward_call(*args, **kwargs)
ERROR 05-06 04:49:57 async_llm_engine.py:57]   File "/vllm/vllm/model_executor/models/llama.py", line 287, in forward
ERROR 05-06 04:49:57 async_llm_engine.py:57]     hidden_states, residual = layer(
ERROR 05-06 04:49:57 async_llm_engine.py:57]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
ERROR 05-06 04:49:57 async_llm_engine.py:57]     return self._call_impl(*args, **kwargs)
ERROR 05-06 04:49:57 async_llm_engine.py:57]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
ERROR 05-06 04:49:57 async_llm_engine.py:57]     return forward_call(*args, **kwargs)
ERROR 05-06 04:49:57 async_llm_engine.py:57]   File "/vllm/vllm/model_executor/models/llama.py", line 234, in forward
ERROR 05-06 04:49:57 async_llm_engine.py:57]     hidden_states = self.mlp(hidden_states)
ERROR 05-06 04:49:57 async_llm_engine.py:57]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
ERROR 05-06 04:49:57 async_llm_engine.py:57]     return self._call_impl(*args, **kwargs)
ERROR 05-06 04:49:57 async_llm_engine.py:57]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
ERROR 05-06 04:49:57 async_llm_engine.py:57]     return forward_call(*args, **kwargs)
ERROR 05-06 04:49:57 async_llm_engine.py:57]   File "/vllm/vllm/model_executor/models/llama.py", line 86, in forward
ERROR 05-06 04:49:57 async_llm_engine.py:57]     gate_up, _ = self.gate_up_proj(x)
ERROR 05-06 04:49:57 async_llm_engine.py:57]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
ERROR 05-06 04:49:57 async_llm_engine.py:57]     return self._call_impl(*args, **kwargs)
ERROR 05-06 04:49:57 async_llm_engine.py:57]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
ERROR 05-06 04:49:57 async_llm_engine.py:57]     return forward_call(*args, **kwargs)
ERROR 05-06 04:49:57 async_llm_engine.py:57]   File "/vllm/vllm/delta/layers_bitblas.py", line 286, in forward
ERROR 05-06 04:49:57 async_llm_engine.py:57]     output_parallel = self.apply_weights(x, bias)
ERROR 05-06 04:49:57 async_llm_engine.py:57]   File "/vllm/vllm/delta/layers_bitblas.py", line 459, in apply_weights
ERROR 05-06 04:49:57 async_llm_engine.py:57]     output = apply_delta_packed_nslice(
ERROR 05-06 04:49:57 async_llm_engine.py:57]   File "/vllm/vllm/delta/deltazip.py", line 148, in apply_delta_packed_nslice
ERROR 05-06 04:49:57 async_llm_engine.py:57]     add_delta_slice(
ERROR 05-06 04:49:57 async_llm_engine.py:57]   File "/vllm/vllm/delta/deltazip.py", line 70, in add_delta_slice
ERROR 05-06 04:49:57 async_llm_engine.py:57]     quant_select_bmm_248(
ERROR 05-06 04:49:57 async_llm_engine.py:57]   File "/triteia/triteia/ao/ops/linalg/select_matmul/select_bmm.py", line 37, in bitblas_quant_select_bmm_248
ERROR 05-06 04:49:57 async_llm_engine.py:57]     valid_qweights = qweight.index_select(0, valid_indices)
ERROR 05-06 04:49:57 async_llm_engine.py:57] torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 5.63 GiB. GPU 0 has a total capacty of 79.33 GiB of which 2.08 GiB is free. Including non-PyTorch memory, this process has 75.59 GiB memory in use. Process 109515 has 414.00 MiB memory in use. Process 109858 has 414.00 MiB memory in use. Process 109100 has 414.00 MiB memory in use. Of the allocated memory 72.40 GiB is allocated by PyTorch, and 1.46 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Exception in callback functools.partial(<function _raise_exception_on_finish at 0x7f955f84e710>, error_callback=<bound method AsyncLLMEngine._error_callback of <vllm.engine.async_llm_engine.AsyncLLMEngine object at 0x7f95409fff40>>)
handle: <Handle functools.partial(<function _raise_exception_on_finish at 0x7f955f84e710>, error_callback=<bound method AsyncLLMEngine._error_callback of <vllm.engine.async_llm_engine.AsyncLLMEngine object at 0x7f95409fff40>>)>
Traceback (most recent call last):
  File "/vllm/vllm/engine/async_llm_engine.py", line 52, in _raise_exception_on_finish
    task.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 531, in run_engine_loop
    has_requests_in_progress = await asyncio.wait_for(
  File "/usr/lib/python3.10/asyncio/tasks.py", line 445, in wait_for
    return fut.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 504, in engine_step
    request_outputs = await self.engine.step_async()
  File "/vllm/vllm/engine/async_llm_engine.py", line 224, in step_async
    output = await self.model_executor.execute_model_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 487, in execute_model_async
    all_outputs = await self._run_workers_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 476, in _run_workers_async
    all_outputs = await asyncio.gather(*coros)
  File "/usr/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/worker.py", line 249, in execute_model
    output = self.model_runner.execute_model(
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/model_runner.py", line 861, in execute_model
    hidden_states = model_executable(**execute_model_kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 373, in forward
    hidden_states = self.model(input_ids, positions, kv_caches, attn_metadata)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 287, in forward
    hidden_states, residual = layer(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 234, in forward
    hidden_states = self.mlp(hidden_states)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 86, in forward
    gate_up, _ = self.gate_up_proj(x)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/delta/layers_bitblas.py", line 286, in forward
    output_parallel = self.apply_weights(x, bias)
  File "/vllm/vllm/delta/layers_bitblas.py", line 459, in apply_weights
    output = apply_delta_packed_nslice(
  File "/vllm/vllm/delta/deltazip.py", line 148, in apply_delta_packed_nslice
    add_delta_slice(
  File "/vllm/vllm/delta/deltazip.py", line 70, in add_delta_slice
    quant_select_bmm_248(
  File "/triteia/triteia/ao/ops/linalg/select_matmul/select_bmm.py", line 37, in bitblas_quant_select_bmm_248
    valid_qweights = qweight.index_select(0, valid_indices)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 5.63 GiB. GPU 0 has a total capacty of 79.33 GiB of which 2.08 GiB is free. Including non-PyTorch memory, this process has 75.59 GiB memory in use. Process 109515 has 414.00 MiB memory in use. Process 109858 has 414.00 MiB memory in use. Process 109100 has 414.00 MiB memory in use. Of the allocated memory 72.40 GiB is allocated by PyTorch, and 1.46 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "uvloop/cbhandles.pyx", line 63, in uvloop.loop.Handle._run
  File "/vllm/vllm/engine/async_llm_engine.py", line 59, in _raise_exception_on_finish
    raise AsyncEngineDeadError(
vllm.engine.async_llm_engine.AsyncEngineDeadError: Task finished unexpectedly. This should never happen! Please open an issue on Github. See stack trace above for the actual cause.
INFO:     ::1:37968 - "POST /v1/completions HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/engine/async_llm_engine.py", line 52, in _raise_exception_on_finish
    task.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 531, in run_engine_loop
    has_requests_in_progress = await asyncio.wait_for(
  File "/usr/lib/python3.10/asyncio/tasks.py", line 445, in wait_for
    return fut.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 504, in engine_step
    request_outputs = await self.engine.step_async()
  File "/vllm/vllm/engine/async_llm_engine.py", line 224, in step_async
    output = await self.model_executor.execute_model_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 487, in execute_model_async
    all_outputs = await self._run_workers_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 476, in _run_workers_async
    all_outputs = await asyncio.gather(*coros)
  File "/usr/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/worker.py", line 249, in execute_model
    output = self.model_runner.execute_model(
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/model_runner.py", line 861, in execute_model
    hidden_states = model_executable(**execute_model_kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 373, in forward
    hidden_states = self.model(input_ids, positions, kv_caches, attn_metadata)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 287, in forward
    hidden_states, residual = layer(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 234, in forward
    hidden_states = self.mlp(hidden_states)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 86, in forward
    gate_up, _ = self.gate_up_proj(x)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/delta/layers_bitblas.py", line 286, in forward
    output_parallel = self.apply_weights(x, bias)
  File "/vllm/vllm/delta/layers_bitblas.py", line 459, in apply_weights
    output = apply_delta_packed_nslice(
  File "/vllm/vllm/delta/deltazip.py", line 148, in apply_delta_packed_nslice
    add_delta_slice(
  File "/vllm/vllm/delta/deltazip.py", line 70, in add_delta_slice
    quant_select_bmm_248(
  File "/triteia/triteia/ao/ops/linalg/select_matmul/select_bmm.py", line 37, in bitblas_quant_select_bmm_248
    valid_qweights = qweight.index_select(0, valid_indices)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 5.63 GiB. GPU 0 has a total capacty of 79.33 GiB of which 2.08 GiB is free. Including non-PyTorch memory, this process has 75.59 GiB memory in use. Process 109515 has 414.00 MiB memory in use. Process 109858 has 414.00 MiB memory in use. Process 109100 has 414.00 MiB memory in use. Of the allocated memory 72.40 GiB is allocated by PyTorch, and 1.46 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
INFO:     ::1:37980 - "POST /v1/completions HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/engine/async_llm_engine.py", line 52, in _raise_exception_on_finish
    task.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 531, in run_engine_loop
    has_requests_in_progress = await asyncio.wait_for(
  File "/usr/lib/python3.10/asyncio/tasks.py", line 445, in wait_for
    return fut.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 504, in engine_step
    request_outputs = await self.engine.step_async()
  File "/vllm/vllm/engine/async_llm_engine.py", line 224, in step_async
    output = await self.model_executor.execute_model_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 487, in execute_model_async
    all_outputs = await self._run_workers_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 476, in _run_workers_async
    all_outputs = await asyncio.gather(*coros)
  File "/usr/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/worker.py", line 249, in execute_model
    output = self.model_runner.execute_model(
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/model_runner.py", line 861, in execute_model
    hidden_states = model_executable(**execute_model_kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 373, in forward
    hidden_states = self.model(input_ids, positions, kv_caches, attn_metadata)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 287, in forward
    hidden_states, residual = layer(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 234, in forward
    hidden_states = self.mlp(hidden_states)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 86, in forward
    gate_up, _ = self.gate_up_proj(x)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/delta/layers_bitblas.py", line 286, in forward
    output_parallel = self.apply_weights(x, bias)
  File "/vllm/vllm/delta/layers_bitblas.py", line 459, in apply_weights
    output = apply_delta_packed_nslice(
  File "/vllm/vllm/delta/deltazip.py", line 148, in apply_delta_packed_nslice
    add_delta_slice(
  File "/vllm/vllm/delta/deltazip.py", line 70, in add_delta_slice
    quant_select_bmm_248(
  File "/triteia/triteia/ao/ops/linalg/select_matmul/select_bmm.py", line 37, in bitblas_quant_select_bmm_248
    valid_qweights = qweight.index_select(0, valid_indices)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 5.63 GiB. GPU 0 has a total capacty of 79.33 GiB of which 2.08 GiB is free. Including non-PyTorch memory, this process has 75.59 GiB memory in use. Process 109515 has 414.00 MiB memory in use. Process 109858 has 414.00 MiB memory in use. Process 109100 has 414.00 MiB memory in use. Of the allocated memory 72.40 GiB is allocated by PyTorch, and 1.46 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
INFO:     ::1:37984 - "POST /v1/completions HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/engine/async_llm_engine.py", line 52, in _raise_exception_on_finish
    task.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 531, in run_engine_loop
    has_requests_in_progress = await asyncio.wait_for(
  File "/usr/lib/python3.10/asyncio/tasks.py", line 445, in wait_for
    return fut.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 504, in engine_step
    request_outputs = await self.engine.step_async()
  File "/vllm/vllm/engine/async_llm_engine.py", line 224, in step_async
    output = await self.model_executor.execute_model_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 487, in execute_model_async
    all_outputs = await self._run_workers_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 476, in _run_workers_async
    all_outputs = await asyncio.gather(*coros)
  File "/usr/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/worker.py", line 249, in execute_model
    output = self.model_runner.execute_model(
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/model_runner.py", line 861, in execute_model
    hidden_states = model_executable(**execute_model_kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 373, in forward
    hidden_states = self.model(input_ids, positions, kv_caches, attn_metadata)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 287, in forward
    hidden_states, residual = layer(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 234, in forward
    hidden_states = self.mlp(hidden_states)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 86, in forward
    gate_up, _ = self.gate_up_proj(x)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/delta/layers_bitblas.py", line 286, in forward
    output_parallel = self.apply_weights(x, bias)
  File "/vllm/vllm/delta/layers_bitblas.py", line 459, in apply_weights
    output = apply_delta_packed_nslice(
  File "/vllm/vllm/delta/deltazip.py", line 148, in apply_delta_packed_nslice
    add_delta_slice(
  File "/vllm/vllm/delta/deltazip.py", line 70, in add_delta_slice
    quant_select_bmm_248(
  File "/triteia/triteia/ao/ops/linalg/select_matmul/select_bmm.py", line 37, in bitblas_quant_select_bmm_248
    valid_qweights = qweight.index_select(0, valid_indices)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 5.63 GiB. GPU 0 has a total capacty of 79.33 GiB of which 2.08 GiB is free. Including non-PyTorch memory, this process has 75.59 GiB memory in use. Process 109515 has 414.00 MiB memory in use. Process 109858 has 414.00 MiB memory in use. Process 109100 has 414.00 MiB memory in use. Of the allocated memory 72.40 GiB is allocated by PyTorch, and 1.46 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
INFO:     ::1:37988 - "POST /v1/completions HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/engine/async_llm_engine.py", line 52, in _raise_exception_on_finish
    task.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 531, in run_engine_loop
    has_requests_in_progress = await asyncio.wait_for(
  File "/usr/lib/python3.10/asyncio/tasks.py", line 445, in wait_for
    return fut.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 504, in engine_step
    request_outputs = await self.engine.step_async()
  File "/vllm/vllm/engine/async_llm_engine.py", line 224, in step_async
    output = await self.model_executor.execute_model_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 487, in execute_model_async
    all_outputs = await self._run_workers_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 476, in _run_workers_async
    all_outputs = await asyncio.gather(*coros)
  File "/usr/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/worker.py", line 249, in execute_model
    output = self.model_runner.execute_model(
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/model_runner.py", line 861, in execute_model
    hidden_states = model_executable(**execute_model_kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 373, in forward
    hidden_states = self.model(input_ids, positions, kv_caches, attn_metadata)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 287, in forward
    hidden_states, residual = layer(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 234, in forward
    hidden_states = self.mlp(hidden_states)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 86, in forward
    gate_up, _ = self.gate_up_proj(x)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/delta/layers_bitblas.py", line 286, in forward
    output_parallel = self.apply_weights(x, bias)
  File "/vllm/vllm/delta/layers_bitblas.py", line 459, in apply_weights
    output = apply_delta_packed_nslice(
  File "/vllm/vllm/delta/deltazip.py", line 148, in apply_delta_packed_nslice
    add_delta_slice(
  File "/vllm/vllm/delta/deltazip.py", line 70, in add_delta_slice
    quant_select_bmm_248(
  File "/triteia/triteia/ao/ops/linalg/select_matmul/select_bmm.py", line 37, in bitblas_quant_select_bmm_248
    valid_qweights = qweight.index_select(0, valid_indices)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 5.63 GiB. GPU 0 has a total capacty of 79.33 GiB of which 2.08 GiB is free. Including non-PyTorch memory, this process has 75.59 GiB memory in use. Process 109515 has 414.00 MiB memory in use. Process 109858 has 414.00 MiB memory in use. Process 109100 has 414.00 MiB memory in use. Of the allocated memory 72.40 GiB is allocated by PyTorch, and 1.46 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
INFO:     ::1:37996 - "POST /v1/completions HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/engine/async_llm_engine.py", line 52, in _raise_exception_on_finish
    task.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 531, in run_engine_loop
    has_requests_in_progress = await asyncio.wait_for(
  File "/usr/lib/python3.10/asyncio/tasks.py", line 445, in wait_for
    return fut.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 504, in engine_step
    request_outputs = await self.engine.step_async()
  File "/vllm/vllm/engine/async_llm_engine.py", line 224, in step_async
    output = await self.model_executor.execute_model_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 487, in execute_model_async
    all_outputs = await self._run_workers_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 476, in _run_workers_async
    all_outputs = await asyncio.gather(*coros)
  File "/usr/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/worker.py", line 249, in execute_model
    output = self.model_runner.execute_model(
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/model_runner.py", line 861, in execute_model
    hidden_states = model_executable(**execute_model_kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 373, in forward
    hidden_states = self.model(input_ids, positions, kv_caches, attn_metadata)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 287, in forward
    hidden_states, residual = layer(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 234, in forward
    hidden_states = self.mlp(hidden_states)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 86, in forward
    gate_up, _ = self.gate_up_proj(x)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/delta/layers_bitblas.py", line 286, in forward
    output_parallel = self.apply_weights(x, bias)
  File "/vllm/vllm/delta/layers_bitblas.py", line 459, in apply_weights
    output = apply_delta_packed_nslice(
  File "/vllm/vllm/delta/deltazip.py", line 148, in apply_delta_packed_nslice
    add_delta_slice(
  File "/vllm/vllm/delta/deltazip.py", line 70, in add_delta_slice
    quant_select_bmm_248(
  File "/triteia/triteia/ao/ops/linalg/select_matmul/select_bmm.py", line 37, in bitblas_quant_select_bmm_248
    valid_qweights = qweight.index_select(0, valid_indices)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 5.63 GiB. GPU 0 has a total capacty of 79.33 GiB of which 2.08 GiB is free. Including non-PyTorch memory, this process has 75.59 GiB memory in use. Process 109515 has 414.00 MiB memory in use. Process 109858 has 414.00 MiB memory in use. Process 109100 has 414.00 MiB memory in use. Of the allocated memory 72.40 GiB is allocated by PyTorch, and 1.46 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
INFO:     ::1:38002 - "POST /v1/completions HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/engine/async_llm_engine.py", line 52, in _raise_exception_on_finish
    task.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 531, in run_engine_loop
    has_requests_in_progress = await asyncio.wait_for(
  File "/usr/lib/python3.10/asyncio/tasks.py", line 445, in wait_for
    return fut.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 504, in engine_step
    request_outputs = await self.engine.step_async()
  File "/vllm/vllm/engine/async_llm_engine.py", line 224, in step_async
    output = await self.model_executor.execute_model_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 487, in execute_model_async
    all_outputs = await self._run_workers_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 476, in _run_workers_async
    all_outputs = await asyncio.gather(*coros)
  File "/usr/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/worker.py", line 249, in execute_model
    output = self.model_runner.execute_model(
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/model_runner.py", line 861, in execute_model
    hidden_states = model_executable(**execute_model_kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 373, in forward
    hidden_states = self.model(input_ids, positions, kv_caches, attn_metadata)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 287, in forward
    hidden_states, residual = layer(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 234, in forward
    hidden_states = self.mlp(hidden_states)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 86, in forward
    gate_up, _ = self.gate_up_proj(x)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/delta/layers_bitblas.py", line 286, in forward
    output_parallel = self.apply_weights(x, bias)
  File "/vllm/vllm/delta/layers_bitblas.py", line 459, in apply_weights
    output = apply_delta_packed_nslice(
  File "/vllm/vllm/delta/deltazip.py", line 148, in apply_delta_packed_nslice
    add_delta_slice(
  File "/vllm/vllm/delta/deltazip.py", line 70, in add_delta_slice
    quant_select_bmm_248(
  File "/triteia/triteia/ao/ops/linalg/select_matmul/select_bmm.py", line 37, in bitblas_quant_select_bmm_248
    valid_qweights = qweight.index_select(0, valid_indices)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 5.63 GiB. GPU 0 has a total capacty of 79.33 GiB of which 2.08 GiB is free. Including non-PyTorch memory, this process has 75.59 GiB memory in use. Process 109515 has 414.00 MiB memory in use. Process 109858 has 414.00 MiB memory in use. Process 109100 has 414.00 MiB memory in use. Of the allocated memory 72.40 GiB is allocated by PyTorch, and 1.46 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
INFO:     ::1:38010 - "POST /v1/completions HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/engine/async_llm_engine.py", line 52, in _raise_exception_on_finish
    task.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 531, in run_engine_loop
    has_requests_in_progress = await asyncio.wait_for(
  File "/usr/lib/python3.10/asyncio/tasks.py", line 445, in wait_for
    return fut.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 504, in engine_step
    request_outputs = await self.engine.step_async()
  File "/vllm/vllm/engine/async_llm_engine.py", line 224, in step_async
    output = await self.model_executor.execute_model_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 487, in execute_model_async
    all_outputs = await self._run_workers_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 476, in _run_workers_async
    all_outputs = await asyncio.gather(*coros)
  File "/usr/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/worker.py", line 249, in execute_model
    output = self.model_runner.execute_model(
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/model_runner.py", line 861, in execute_model
    hidden_states = model_executable(**execute_model_kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 373, in forward
    hidden_states = self.model(input_ids, positions, kv_caches, attn_metadata)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 287, in forward
    hidden_states, residual = layer(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 234, in forward
    hidden_states = self.mlp(hidden_states)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 86, in forward
    gate_up, _ = self.gate_up_proj(x)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/delta/layers_bitblas.py", line 286, in forward
    output_parallel = self.apply_weights(x, bias)
  File "/vllm/vllm/delta/layers_bitblas.py", line 459, in apply_weights
    output = apply_delta_packed_nslice(
  File "/vllm/vllm/delta/deltazip.py", line 148, in apply_delta_packed_nslice
    add_delta_slice(
  File "/vllm/vllm/delta/deltazip.py", line 70, in add_delta_slice
    quant_select_bmm_248(
  File "/triteia/triteia/ao/ops/linalg/select_matmul/select_bmm.py", line 37, in bitblas_quant_select_bmm_248
    valid_qweights = qweight.index_select(0, valid_indices)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 5.63 GiB. GPU 0 has a total capacty of 79.33 GiB of which 2.08 GiB is free. Including non-PyTorch memory, this process has 75.59 GiB memory in use. Process 109515 has 414.00 MiB memory in use. Process 109858 has 414.00 MiB memory in use. Process 109100 has 414.00 MiB memory in use. Of the allocated memory 72.40 GiB is allocated by PyTorch, and 1.46 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
INFO:     ::1:38014 - "POST /v1/completions HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/engine/async_llm_engine.py", line 52, in _raise_exception_on_finish
    task.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 531, in run_engine_loop
    has_requests_in_progress = await asyncio.wait_for(
  File "/usr/lib/python3.10/asyncio/tasks.py", line 445, in wait_for
    return fut.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 504, in engine_step
    request_outputs = await self.engine.step_async()
  File "/vllm/vllm/engine/async_llm_engine.py", line 224, in step_async
    output = await self.model_executor.execute_model_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 487, in execute_model_async
    all_outputs = await self._run_workers_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 476, in _run_workers_async
    all_outputs = await asyncio.gather(*coros)
  File "/usr/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/worker.py", line 249, in execute_model
    output = self.model_runner.execute_model(
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/model_runner.py", line 861, in execute_model
    hidden_states = model_executable(**execute_model_kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 373, in forward
    hidden_states = self.model(input_ids, positions, kv_caches, attn_metadata)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 287, in forward
    hidden_states, residual = layer(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 234, in forward
    hidden_states = self.mlp(hidden_states)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 86, in forward
    gate_up, _ = self.gate_up_proj(x)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/delta/layers_bitblas.py", line 286, in forward
    output_parallel = self.apply_weights(x, bias)
  File "/vllm/vllm/delta/layers_bitblas.py", line 459, in apply_weights
    output = apply_delta_packed_nslice(
  File "/vllm/vllm/delta/deltazip.py", line 148, in apply_delta_packed_nslice
    add_delta_slice(
  File "/vllm/vllm/delta/deltazip.py", line 70, in add_delta_slice
    quant_select_bmm_248(
  File "/triteia/triteia/ao/ops/linalg/select_matmul/select_bmm.py", line 37, in bitblas_quant_select_bmm_248
    valid_qweights = qweight.index_select(0, valid_indices)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 5.63 GiB. GPU 0 has a total capacty of 79.33 GiB of which 2.08 GiB is free. Including non-PyTorch memory, this process has 75.59 GiB memory in use. Process 109515 has 414.00 MiB memory in use. Process 109858 has 414.00 MiB memory in use. Process 109100 has 414.00 MiB memory in use. Of the allocated memory 72.40 GiB is allocated by PyTorch, and 1.46 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
INFO:     ::1:38026 - "POST /v1/completions HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/engine/async_llm_engine.py", line 52, in _raise_exception_on_finish
    task.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 531, in run_engine_loop
    has_requests_in_progress = await asyncio.wait_for(
  File "/usr/lib/python3.10/asyncio/tasks.py", line 445, in wait_for
    return fut.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 504, in engine_step
    request_outputs = await self.engine.step_async()
  File "/vllm/vllm/engine/async_llm_engine.py", line 224, in step_async
    output = await self.model_executor.execute_model_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 487, in execute_model_async
    all_outputs = await self._run_workers_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 476, in _run_workers_async
    all_outputs = await asyncio.gather(*coros)
  File "/usr/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/worker.py", line 249, in execute_model
    output = self.model_runner.execute_model(
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/model_runner.py", line 861, in execute_model
    hidden_states = model_executable(**execute_model_kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 373, in forward
    hidden_states = self.model(input_ids, positions, kv_caches, attn_metadata)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 287, in forward
    hidden_states, residual = layer(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 234, in forward
    hidden_states = self.mlp(hidden_states)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 86, in forward
    gate_up, _ = self.gate_up_proj(x)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/delta/layers_bitblas.py", line 286, in forward
    output_parallel = self.apply_weights(x, bias)
  File "/vllm/vllm/delta/layers_bitblas.py", line 459, in apply_weights
    output = apply_delta_packed_nslice(
  File "/vllm/vllm/delta/deltazip.py", line 148, in apply_delta_packed_nslice
    add_delta_slice(
  File "/vllm/vllm/delta/deltazip.py", line 70, in add_delta_slice
    quant_select_bmm_248(
  File "/triteia/triteia/ao/ops/linalg/select_matmul/select_bmm.py", line 37, in bitblas_quant_select_bmm_248
    valid_qweights = qweight.index_select(0, valid_indices)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 5.63 GiB. GPU 0 has a total capacty of 79.33 GiB of which 2.08 GiB is free. Including non-PyTorch memory, this process has 75.59 GiB memory in use. Process 109515 has 414.00 MiB memory in use. Process 109858 has 414.00 MiB memory in use. Process 109100 has 414.00 MiB memory in use. Of the allocated memory 72.40 GiB is allocated by PyTorch, and 1.46 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48] Error executing method execute_model. This might cause deadlock in distributed execution.
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48] Traceback (most recent call last):
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/engine/ray_utils.py", line 39, in execute_method
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return executor(*args, **kwargs)
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return func(*args, **kwargs)
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/worker/worker.py", line 249, in execute_model
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     output = self.model_runner.execute_model(
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return func(*args, **kwargs)
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/worker/model_runner.py", line 861, in execute_model
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     hidden_states = model_executable(**execute_model_kwargs)
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return self._call_impl(*args, **kwargs)
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return forward_call(*args, **kwargs)
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/model_executor/models/llama.py", line 373, in forward
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     hidden_states = self.model(input_ids, positions, kv_caches, attn_metadata)
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return self._call_impl(*args, **kwargs)
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return forward_call(*args, **kwargs)
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/model_executor/models/llama.py", line 287, in forward
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     hidden_states, residual = layer(
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return self._call_impl(*args, **kwargs)
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return forward_call(*args, **kwargs)
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/model_executor/models/llama.py", line 234, in forward
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     hidden_states = self.mlp(hidden_states)
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return self._call_impl(*args, **kwargs)
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return forward_call(*args, **kwargs)
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/model_executor/models/llama.py", line 86, in forward
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     gate_up, _ = self.gate_up_proj(x)
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return self._call_impl(*args, **kwargs)
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return forward_call(*args, **kwargs)
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/delta/layers_bitblas.py", line 286, in forward
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     output_parallel = self.apply_weights(x, bias)
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/delta/layers_bitblas.py", line 459, in apply_weights
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     output = apply_delta_packed_nslice(
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/delta/deltazip.py", line 148, in apply_delta_packed_nslice
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     add_delta_slice(
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/delta/deltazip.py", line 70, in add_delta_slice
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     quant_select_bmm_248(
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/triteia/triteia/ao/ops/linalg/select_matmul/select_bmm.py", line 37, in bitblas_quant_select_bmm_248
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     valid_qweights = qweight.index_select(0, valid_indices)
[36m(RayWorkerVllm pid=109100)[0m ERROR 05-06 04:49:57 ray_utils.py:48] torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 5.63 GiB. GPU 1 has a total capacty of 79.33 GiB of which 3.53 GiB is free. Process 99271 has 414.00 MiB memory in use. Process 109515 has 414.00 MiB memory in use. Process 109858 has 414.00 MiB memory in use. Including non-PyTorch memory, this process has 74.13 GiB memory in use. Of the allocated memory 72.39 GiB is allocated by PyTorch, and 14.16 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
INFO:     ::1:38030 - "POST /v1/completions HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/engine/async_llm_engine.py", line 52, in _raise_exception_on_finish
    task.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 531, in run_engine_loop
    has_requests_in_progress = await asyncio.wait_for(
  File "/usr/lib/python3.10/asyncio/tasks.py", line 445, in wait_for
    return fut.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 504, in engine_step
    request_outputs = await self.engine.step_async()
  File "/vllm/vllm/engine/async_llm_engine.py", line 224, in step_async
    output = await self.model_executor.execute_model_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 487, in execute_model_async
    all_outputs = await self._run_workers_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 476, in _run_workers_async
    all_outputs = await asyncio.gather(*coros)
  File "/usr/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/worker.py", line 249, in execute_model
    output = self.model_runner.execute_model(
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/model_runner.py", line 861, in execute_model
    hidden_states = model_executable(**execute_model_kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 373, in forward
    hidden_states = self.model(input_ids, positions, kv_caches, attn_metadata)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 287, in forward
    hidden_states, residual = layer(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 234, in forward
    hidden_states = self.mlp(hidden_states)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 86, in forward
    gate_up, _ = self.gate_up_proj(x)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/delta/layers_bitblas.py", line 286, in forward
    output_parallel = self.apply_weights(x, bias)
  File "/vllm/vllm/delta/layers_bitblas.py", line 459, in apply_weights
    output = apply_delta_packed_nslice(
  File "/vllm/vllm/delta/deltazip.py", line 148, in apply_delta_packed_nslice
    add_delta_slice(
  File "/vllm/vllm/delta/deltazip.py", line 70, in add_delta_slice
    quant_select_bmm_248(
  File "/triteia/triteia/ao/ops/linalg/select_matmul/select_bmm.py", line 37, in bitblas_quant_select_bmm_248
    valid_qweights = qweight.index_select(0, valid_indices)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 5.63 GiB. GPU 0 has a total capacty of 79.33 GiB of which 2.08 GiB is free. Including non-PyTorch memory, this process has 75.59 GiB memory in use. Process 109515 has 414.00 MiB memory in use. Process 109858 has 414.00 MiB memory in use. Process 109100 has 414.00 MiB memory in use. Of the allocated memory 72.40 GiB is allocated by PyTorch, and 1.46 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48] Error executing method execute_model. This might cause deadlock in distributed execution.
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48] Traceback (most recent call last):
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/engine/ray_utils.py", line 39, in execute_method
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return executor(*args, **kwargs)
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return func(*args, **kwargs)
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/worker/worker.py", line 249, in execute_model
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     output = self.model_runner.execute_model(
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return func(*args, **kwargs)
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/worker/model_runner.py", line 861, in execute_model
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     hidden_states = model_executable(**execute_model_kwargs)
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return self._call_impl(*args, **kwargs)
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return forward_call(*args, **kwargs)
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/model_executor/models/llama.py", line 373, in forward
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     hidden_states = self.model(input_ids, positions, kv_caches, attn_metadata)
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return self._call_impl(*args, **kwargs)
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return forward_call(*args, **kwargs)
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/model_executor/models/llama.py", line 287, in forward
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     hidden_states, residual = layer(
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return self._call_impl(*args, **kwargs)
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return forward_call(*args, **kwargs)
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/model_executor/models/llama.py", line 234, in forward
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     hidden_states = self.mlp(hidden_states)
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return self._call_impl(*args, **kwargs)
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return forward_call(*args, **kwargs)
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/model_executor/models/llama.py", line 86, in forward
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     gate_up, _ = self.gate_up_proj(x)
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return self._call_impl(*args, **kwargs)
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return forward_call(*args, **kwargs)
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/delta/layers_bitblas.py", line 286, in forward
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     output_parallel = self.apply_weights(x, bias)
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/delta/layers_bitblas.py", line 459, in apply_weights
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     output = apply_delta_packed_nslice(
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/delta/deltazip.py", line 148, in apply_delta_packed_nslice
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     add_delta_slice(
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/delta/deltazip.py", line 70, in add_delta_slice
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     quant_select_bmm_248(
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/triteia/triteia/ao/ops/linalg/select_matmul/select_bmm.py", line 37, in bitblas_quant_select_bmm_248
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     valid_qweights = qweight.index_select(0, valid_indices)
[36m(RayWorkerVllm pid=109515)[0m ERROR 05-06 04:49:57 ray_utils.py:48] torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 5.63 GiB. GPU 2 has a total capacty of 79.33 GiB of which 3.53 GiB is free. Process 99271 has 414.00 MiB memory in use. Including non-PyTorch memory, this process has 74.13 GiB memory in use. Process 109858 has 414.00 MiB memory in use. Process 109100 has 414.00 MiB memory in use. Of the allocated memory 72.39 GiB is allocated by PyTorch, and 14.16 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48] Error executing method execute_model. This might cause deadlock in distributed execution.
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48] Traceback (most recent call last):
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/engine/ray_utils.py", line 39, in execute_method
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return executor(*args, **kwargs)
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return func(*args, **kwargs)
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/worker/worker.py", line 249, in execute_model
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     output = self.model_runner.execute_model(
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return func(*args, **kwargs)
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/worker/model_runner.py", line 861, in execute_model
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     hidden_states = model_executable(**execute_model_kwargs)
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return self._call_impl(*args, **kwargs)
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return forward_call(*args, **kwargs)
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/model_executor/models/llama.py", line 373, in forward
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     hidden_states = self.model(input_ids, positions, kv_caches, attn_metadata)
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return self._call_impl(*args, **kwargs)
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return forward_call(*args, **kwargs)
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/model_executor/models/llama.py", line 287, in forward
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     hidden_states, residual = layer(
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return self._call_impl(*args, **kwargs)
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return forward_call(*args, **kwargs)
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/model_executor/models/llama.py", line 234, in forward
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     hidden_states = self.mlp(hidden_states)
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return self._call_impl(*args, **kwargs)
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return forward_call(*args, **kwargs)
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/model_executor/models/llama.py", line 86, in forward
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     gate_up, _ = self.gate_up_proj(x)
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return self._call_impl(*args, **kwargs)
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     return forward_call(*args, **kwargs)
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/delta/layers_bitblas.py", line 286, in forward
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     output_parallel = self.apply_weights(x, bias)
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/delta/layers_bitblas.py", line 459, in apply_weights
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     output = apply_delta_packed_nslice(
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/delta/deltazip.py", line 148, in apply_delta_packed_nslice
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     add_delta_slice(
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/vllm/vllm/delta/deltazip.py", line 70, in add_delta_slice
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     quant_select_bmm_248(
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]   File "/triteia/triteia/ao/ops/linalg/select_matmul/select_bmm.py", line 37, in bitblas_quant_select_bmm_248
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48]     valid_qweights = qweight.index_select(0, valid_indices)
[36m(RayWorkerVllm pid=109858)[0m ERROR 05-06 04:49:57 ray_utils.py:48] torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 5.63 GiB. GPU 3 has a total capacty of 79.33 GiB of which 3.72 GiB is free. Process 99271 has 414.00 MiB memory in use. Process 109515 has 414.00 MiB memory in use. Including non-PyTorch memory, this process has 73.94 GiB memory in use. Process 109100 has 414.00 MiB memory in use. Of the allocated memory 72.39 GiB is allocated by PyTorch, and 14.16 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
INFO:     ::1:38048 - "POST /v1/completions HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/engine/async_llm_engine.py", line 52, in _raise_exception_on_finish
    task.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 531, in run_engine_loop
    has_requests_in_progress = await asyncio.wait_for(
  File "/usr/lib/python3.10/asyncio/tasks.py", line 445, in wait_for
    return fut.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 504, in engine_step
    request_outputs = await self.engine.step_async()
  File "/vllm/vllm/engine/async_llm_engine.py", line 224, in step_async
    output = await self.model_executor.execute_model_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 487, in execute_model_async
    all_outputs = await self._run_workers_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 476, in _run_workers_async
    all_outputs = await asyncio.gather(*coros)
  File "/usr/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/worker.py", line 249, in execute_model
    output = self.model_runner.execute_model(
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/model_runner.py", line 861, in execute_model
    hidden_states = model_executable(**execute_model_kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 373, in forward
    hidden_states = self.model(input_ids, positions, kv_caches, attn_metadata)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 287, in forward
    hidden_states, residual = layer(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 234, in forward
    hidden_states = self.mlp(hidden_states)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 86, in forward
    gate_up, _ = self.gate_up_proj(x)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/delta/layers_bitblas.py", line 286, in forward
    output_parallel = self.apply_weights(x, bias)
  File "/vllm/vllm/delta/layers_bitblas.py", line 459, in apply_weights
    output = apply_delta_packed_nslice(
  File "/vllm/vllm/delta/deltazip.py", line 148, in apply_delta_packed_nslice
    add_delta_slice(
  File "/vllm/vllm/delta/deltazip.py", line 70, in add_delta_slice
    quant_select_bmm_248(
  File "/triteia/triteia/ao/ops/linalg/select_matmul/select_bmm.py", line 37, in bitblas_quant_select_bmm_248
    valid_qweights = qweight.index_select(0, valid_indices)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 5.63 GiB. GPU 0 has a total capacty of 79.33 GiB of which 2.08 GiB is free. Including non-PyTorch memory, this process has 75.59 GiB memory in use. Process 109515 has 414.00 MiB memory in use. Process 109858 has 414.00 MiB memory in use. Process 109100 has 414.00 MiB memory in use. Of the allocated memory 72.40 GiB is allocated by PyTorch, and 1.46 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
INFO:     ::1:38054 - "POST /v1/completions HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/engine/async_llm_engine.py", line 52, in _raise_exception_on_finish
    task.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 531, in run_engine_loop
    has_requests_in_progress = await asyncio.wait_for(
  File "/usr/lib/python3.10/asyncio/tasks.py", line 445, in wait_for
    return fut.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 504, in engine_step
    request_outputs = await self.engine.step_async()
  File "/vllm/vllm/engine/async_llm_engine.py", line 224, in step_async
    output = await self.model_executor.execute_model_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 487, in execute_model_async
    all_outputs = await self._run_workers_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 476, in _run_workers_async
    all_outputs = await asyncio.gather(*coros)
  File "/usr/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/worker.py", line 249, in execute_model
    output = self.model_runner.execute_model(
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/model_runner.py", line 861, in execute_model
    hidden_states = model_executable(**execute_model_kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 373, in forward
    hidden_states = self.model(input_ids, positions, kv_caches, attn_metadata)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 287, in forward
    hidden_states, residual = layer(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 234, in forward
    hidden_states = self.mlp(hidden_states)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 86, in forward
    gate_up, _ = self.gate_up_proj(x)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/delta/layers_bitblas.py", line 286, in forward
    output_parallel = self.apply_weights(x, bias)
  File "/vllm/vllm/delta/layers_bitblas.py", line 459, in apply_weights
    output = apply_delta_packed_nslice(
  File "/vllm/vllm/delta/deltazip.py", line 148, in apply_delta_packed_nslice
    add_delta_slice(
  File "/vllm/vllm/delta/deltazip.py", line 70, in add_delta_slice
    quant_select_bmm_248(
  File "/triteia/triteia/ao/ops/linalg/select_matmul/select_bmm.py", line 37, in bitblas_quant_select_bmm_248
    valid_qweights = qweight.index_select(0, valid_indices)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 5.63 GiB. GPU 0 has a total capacty of 79.33 GiB of which 2.08 GiB is free. Including non-PyTorch memory, this process has 75.59 GiB memory in use. Process 109515 has 414.00 MiB memory in use. Process 109858 has 414.00 MiB memory in use. Process 109100 has 414.00 MiB memory in use. Of the allocated memory 72.40 GiB is allocated by PyTorch, and 1.46 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
INFO:     ::1:38056 - "POST /v1/completions HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/engine/async_llm_engine.py", line 52, in _raise_exception_on_finish
    task.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 531, in run_engine_loop
    has_requests_in_progress = await asyncio.wait_for(
  File "/usr/lib/python3.10/asyncio/tasks.py", line 445, in wait_for
    return fut.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 504, in engine_step
    request_outputs = await self.engine.step_async()
  File "/vllm/vllm/engine/async_llm_engine.py", line 224, in step_async
    output = await self.model_executor.execute_model_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 487, in execute_model_async
    all_outputs = await self._run_workers_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 476, in _run_workers_async
    all_outputs = await asyncio.gather(*coros)
  File "/usr/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/worker.py", line 249, in execute_model
    output = self.model_runner.execute_model(
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/model_runner.py", line 861, in execute_model
    hidden_states = model_executable(**execute_model_kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 373, in forward
    hidden_states = self.model(input_ids, positions, kv_caches, attn_metadata)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 287, in forward
    hidden_states, residual = layer(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 234, in forward
    hidden_states = self.mlp(hidden_states)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 86, in forward
    gate_up, _ = self.gate_up_proj(x)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/delta/layers_bitblas.py", line 286, in forward
    output_parallel = self.apply_weights(x, bias)
  File "/vllm/vllm/delta/layers_bitblas.py", line 459, in apply_weights
    output = apply_delta_packed_nslice(
  File "/vllm/vllm/delta/deltazip.py", line 148, in apply_delta_packed_nslice
    add_delta_slice(
  File "/vllm/vllm/delta/deltazip.py", line 70, in add_delta_slice
    quant_select_bmm_248(
  File "/triteia/triteia/ao/ops/linalg/select_matmul/select_bmm.py", line 37, in bitblas_quant_select_bmm_248
    valid_qweights = qweight.index_select(0, valid_indices)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 5.63 GiB. GPU 0 has a total capacty of 79.33 GiB of which 2.08 GiB is free. Including non-PyTorch memory, this process has 75.59 GiB memory in use. Process 109515 has 414.00 MiB memory in use. Process 109858 has 414.00 MiB memory in use. Process 109100 has 414.00 MiB memory in use. Of the allocated memory 72.40 GiB is allocated by PyTorch, and 1.46 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
INFO:     ::1:38070 - "POST /v1/completions HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/engine/async_llm_engine.py", line 52, in _raise_exception_on_finish
    task.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 531, in run_engine_loop
    has_requests_in_progress = await asyncio.wait_for(
  File "/usr/lib/python3.10/asyncio/tasks.py", line 445, in wait_for
    return fut.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 504, in engine_step
    request_outputs = await self.engine.step_async()
  File "/vllm/vllm/engine/async_llm_engine.py", line 224, in step_async
    output = await self.model_executor.execute_model_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 487, in execute_model_async
    all_outputs = await self._run_workers_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 476, in _run_workers_async
    all_outputs = await asyncio.gather(*coros)
  File "/usr/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/worker.py", line 249, in execute_model
    output = self.model_runner.execute_model(
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/model_runner.py", line 861, in execute_model
    hidden_states = model_executable(**execute_model_kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 373, in forward
    hidden_states = self.model(input_ids, positions, kv_caches, attn_metadata)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 287, in forward
    hidden_states, residual = layer(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 234, in forward
    hidden_states = self.mlp(hidden_states)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 86, in forward
    gate_up, _ = self.gate_up_proj(x)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/delta/layers_bitblas.py", line 286, in forward
    output_parallel = self.apply_weights(x, bias)
  File "/vllm/vllm/delta/layers_bitblas.py", line 459, in apply_weights
    output = apply_delta_packed_nslice(
  File "/vllm/vllm/delta/deltazip.py", line 148, in apply_delta_packed_nslice
    add_delta_slice(
  File "/vllm/vllm/delta/deltazip.py", line 70, in add_delta_slice
    quant_select_bmm_248(
  File "/triteia/triteia/ao/ops/linalg/select_matmul/select_bmm.py", line 37, in bitblas_quant_select_bmm_248
    valid_qweights = qweight.index_select(0, valid_indices)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 5.63 GiB. GPU 0 has a total capacty of 79.33 GiB of which 2.08 GiB is free. Including non-PyTorch memory, this process has 75.59 GiB memory in use. Process 109515 has 414.00 MiB memory in use. Process 109858 has 414.00 MiB memory in use. Process 109100 has 414.00 MiB memory in use. Of the allocated memory 72.40 GiB is allocated by PyTorch, and 1.46 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
INFO:     ::1:38102 - "POST /v1/completions HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/engine/async_llm_engine.py", line 52, in _raise_exception_on_finish
    task.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 531, in run_engine_loop
    has_requests_in_progress = await asyncio.wait_for(
  File "/usr/lib/python3.10/asyncio/tasks.py", line 445, in wait_for
    return fut.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 504, in engine_step
    request_outputs = await self.engine.step_async()
  File "/vllm/vllm/engine/async_llm_engine.py", line 224, in step_async
    output = await self.model_executor.execute_model_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 487, in execute_model_async
    all_outputs = await self._run_workers_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 476, in _run_workers_async
    all_outputs = await asyncio.gather(*coros)
  File "/usr/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/worker.py", line 249, in execute_model
    output = self.model_runner.execute_model(
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/model_runner.py", line 861, in execute_model
    hidden_states = model_executable(**execute_model_kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 373, in forward
    hidden_states = self.model(input_ids, positions, kv_caches, attn_metadata)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 287, in forward
    hidden_states, residual = layer(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 234, in forward
    hidden_states = self.mlp(hidden_states)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 86, in forward
    gate_up, _ = self.gate_up_proj(x)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/delta/layers_bitblas.py", line 286, in forward
    output_parallel = self.apply_weights(x, bias)
  File "/vllm/vllm/delta/layers_bitblas.py", line 459, in apply_weights
    output = apply_delta_packed_nslice(
  File "/vllm/vllm/delta/deltazip.py", line 148, in apply_delta_packed_nslice
    add_delta_slice(
  File "/vllm/vllm/delta/deltazip.py", line 70, in add_delta_slice
    quant_select_bmm_248(
  File "/triteia/triteia/ao/ops/linalg/select_matmul/select_bmm.py", line 37, in bitblas_quant_select_bmm_248
    valid_qweights = qweight.index_select(0, valid_indices)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 5.63 GiB. GPU 0 has a total capacty of 79.33 GiB of which 2.08 GiB is free. Including non-PyTorch memory, this process has 75.59 GiB memory in use. Process 109515 has 414.00 MiB memory in use. Process 109858 has 414.00 MiB memory in use. Process 109100 has 414.00 MiB memory in use. Of the allocated memory 72.40 GiB is allocated by PyTorch, and 1.46 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
INFO:     ::1:38126 - "POST /v1/completions HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/engine/async_llm_engine.py", line 52, in _raise_exception_on_finish
    task.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 531, in run_engine_loop
    has_requests_in_progress = await asyncio.wait_for(
  File "/usr/lib/python3.10/asyncio/tasks.py", line 445, in wait_for
    return fut.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 504, in engine_step
    request_outputs = await self.engine.step_async()
  File "/vllm/vllm/engine/async_llm_engine.py", line 224, in step_async
    output = await self.model_executor.execute_model_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 487, in execute_model_async
    all_outputs = await self._run_workers_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 476, in _run_workers_async
    all_outputs = await asyncio.gather(*coros)
  File "/usr/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/worker.py", line 249, in execute_model
    output = self.model_runner.execute_model(
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/model_runner.py", line 861, in execute_model
    hidden_states = model_executable(**execute_model_kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 373, in forward
    hidden_states = self.model(input_ids, positions, kv_caches, attn_metadata)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 287, in forward
    hidden_states, residual = layer(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 234, in forward
    hidden_states = self.mlp(hidden_states)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 86, in forward
    gate_up, _ = self.gate_up_proj(x)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/delta/layers_bitblas.py", line 286, in forward
    output_parallel = self.apply_weights(x, bias)
  File "/vllm/vllm/delta/layers_bitblas.py", line 459, in apply_weights
    output = apply_delta_packed_nslice(
  File "/vllm/vllm/delta/deltazip.py", line 148, in apply_delta_packed_nslice
    add_delta_slice(
  File "/vllm/vllm/delta/deltazip.py", line 70, in add_delta_slice
    quant_select_bmm_248(
  File "/triteia/triteia/ao/ops/linalg/select_matmul/select_bmm.py", line 37, in bitblas_quant_select_bmm_248
    valid_qweights = qweight.index_select(0, valid_indices)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 5.63 GiB. GPU 0 has a total capacty of 79.33 GiB of which 2.08 GiB is free. Including non-PyTorch memory, this process has 75.59 GiB memory in use. Process 109515 has 414.00 MiB memory in use. Process 109858 has 414.00 MiB memory in use. Process 109100 has 414.00 MiB memory in use. Of the allocated memory 72.40 GiB is allocated by PyTorch, and 1.46 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
INFO:     ::1:38138 - "POST /v1/completions HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/engine/async_llm_engine.py", line 52, in _raise_exception_on_finish
    task.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 531, in run_engine_loop
    has_requests_in_progress = await asyncio.wait_for(
  File "/usr/lib/python3.10/asyncio/tasks.py", line 445, in wait_for
    return fut.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 504, in engine_step
    request_outputs = await self.engine.step_async()
  File "/vllm/vllm/engine/async_llm_engine.py", line 224, in step_async
    output = await self.model_executor.execute_model_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 487, in execute_model_async
    all_outputs = await self._run_workers_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 476, in _run_workers_async
    all_outputs = await asyncio.gather(*coros)
  File "/usr/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/worker.py", line 249, in execute_model
    output = self.model_runner.execute_model(
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/model_runner.py", line 861, in execute_model
    hidden_states = model_executable(**execute_model_kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 373, in forward
    hidden_states = self.model(input_ids, positions, kv_caches, attn_metadata)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 287, in forward
    hidden_states, residual = layer(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 234, in forward
    hidden_states = self.mlp(hidden_states)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 86, in forward
    gate_up, _ = self.gate_up_proj(x)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/delta/layers_bitblas.py", line 286, in forward
    output_parallel = self.apply_weights(x, bias)
  File "/vllm/vllm/delta/layers_bitblas.py", line 459, in apply_weights
    output = apply_delta_packed_nslice(
  File "/vllm/vllm/delta/deltazip.py", line 148, in apply_delta_packed_nslice
    add_delta_slice(
  File "/vllm/vllm/delta/deltazip.py", line 70, in add_delta_slice
    quant_select_bmm_248(
  File "/triteia/triteia/ao/ops/linalg/select_matmul/select_bmm.py", line 37, in bitblas_quant_select_bmm_248
    valid_qweights = qweight.index_select(0, valid_indices)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 5.63 GiB. GPU 0 has a total capacty of 79.33 GiB of which 2.08 GiB is free. Including non-PyTorch memory, this process has 75.59 GiB memory in use. Process 109515 has 414.00 MiB memory in use. Process 109858 has 414.00 MiB memory in use. Process 109100 has 414.00 MiB memory in use. Of the allocated memory 72.40 GiB is allocated by PyTorch, and 1.46 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
INFO:     ::1:38144 - "POST /v1/completions HTTP/1.1" 500 Internal Server Error
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/protocols/http/httptools_impl.py", line 411, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
  File "/usr/local/lib/python3.10/dist-packages/uvicorn/middleware/proxy_headers.py", line 69, in __call__
    return await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/applications.py", line 1054, in __call__
    await super().__call__(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 186, in __call__
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/middleware/exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 77, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "/usr/local/lib/python3.10/dist-packages/starlette/_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "/usr/local/lib/python3.10/dist-packages/starlette/routing.py", line 72, in app
    response = await func(request)
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 278, in app
    raw_response = await run_endpoint_function(
  File "/usr/local/lib/python3.10/dist-packages/fastapi/routing.py", line 191, in run_endpoint_function
    return await dependant.call(**values)
  File "/vllm/vllm/entrypoints/openai/api_server.py", line 147, in create_completion
    generator = await openai_serving_completion.create_completion(
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 211, in create_completion
    async for i, res in result_generator:
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 90, in consumer
    raise item
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/entrypoints/openai/serving_completion.py", line 75, in producer
    async for item in iterator:
  File "/vllm/vllm/engine/async_llm_engine.py", line 725, in generate
    raise e
  File "/vllm/vllm/engine/async_llm_engine.py", line 719, in generate
    async for request_output in stream:
  File "/vllm/vllm/engine/async_llm_engine.py", line 92, in __anext__
    raise result
  File "/vllm/vllm/engine/async_llm_engine.py", line 52, in _raise_exception_on_finish
    task.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 531, in run_engine_loop
    has_requests_in_progress = await asyncio.wait_for(
  File "/usr/lib/python3.10/asyncio/tasks.py", line 445, in wait_for
    return fut.result()
  File "/vllm/vllm/engine/async_llm_engine.py", line 504, in engine_step
    request_outputs = await self.engine.step_async()
  File "/vllm/vllm/engine/async_llm_engine.py", line 224, in step_async
    output = await self.model_executor.execute_model_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 487, in execute_model_async
    all_outputs = await self._run_workers_async(
  File "/vllm/vllm/executor/ray_gpu_executor.py", line 476, in _run_workers_async
    all_outputs = await asyncio.gather(*coros)
  File "/usr/lib/python3.10/concurrent/futures/thread.py", line 58, in run
    result = self.fn(*self.args, **self.kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/worker.py", line 249, in execute_model
    output = self.model_runner.execute_model(
  File "/usr/local/lib/python3.10/dist-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/vllm/vllm/worker/model_runner.py", line 861, in execute_model
    hidden_states = model_executable(**execute_model_kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 373, in forward
    hidden_states = self.model(input_ids, positions, kv_caches, attn_metadata)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 287, in forward
    hidden_states, residual = layer(
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 234, in forward
    hidden_states = self.mlp(hidden_states)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/model_executor/models/llama.py", line 86, in forward
    gate_up, _ = self.gate_up_proj(x)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/usr/local/lib/python3.10/dist-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/vllm/vllm/delta/layers_bitblas.py", line 286, in forward
    output_parallel = self.apply_weights(x, bias)
  File "/vllm/vllm/delta/layers_bitblas.py", line 459, in apply_weights
    output = apply_delta_packed_nslice(
  File "/vllm/vllm/delta/deltazip.py", line 148, in apply_delta_packed_nslice
    add_delta_slice(
  File "/vllm/vllm/delta/deltazip.py", line 70, in add_delta_slice
    quant_select_bmm_248(
  File "/triteia/triteia/ao/ops/linalg/select_matmul/select_bmm.py", line 37, in bitblas_quant_select_bmm_248
    valid_qweights = qweight.index_select(0, valid_indices)
torch.cuda.OutOfMemoryError: CUDA out of memory. Tried to allocate 5.63 GiB. GPU 0 has a total capacty of 79.33 GiB of which 2.08 GiB is free. Including non-PyTorch memory, this process has 75.59 GiB memory in use. Process 109515 has 414.00 MiB memory in use. Process 109858 has 414.00 MiB memory in use. Process 109100 has 414.00 MiB memory in use. Of the allocated memory 72.40 GiB is allocated by PyTorch, and 1.46 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
Failed to issue request: Internal Server Error
Exception in thread Thread-13 (request_thread):
Failed to issue request: Internal Server Error
Traceback (most recent call last):
Failed to issue request: Internal Server Error
Exception in thread Thread-16 (request_thread):
Failed to issue request: Internal Server Error
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 971, in json
Failed to issue request: Internal Server Error
Traceback (most recent call last):
Failed to issue request: Internal Server Error
Exception in thread Thread-15 (request_thread):
Failed to issue request: Internal Server Error
Exception in thread Thread-1 (request_thread):
Failed to issue request: Internal Server Error
Exception in thread Thread-9 (request_thread):
Failed to issue request: Internal Server Error
Traceback (most recent call last):
Failed to issue request: Internal Server Error
Exception in thread Thread-4 (request_thread):
Failed to issue request: Internal Server Error
Exception in thread Thread-21 (request_thread):
Failed to issue request: Internal Server Error
Traceback (most recent call last):
Failed to issue request: Internal Server Error
Exception in thread Thread-7 (request_thread):
Failed to issue request: Internal Server Error
Exception in thread Thread-3 (request_thread):
Failed to issue request: Internal Server Error
Traceback (most recent call last):
Failed to issue request: Internal Server Error
Exception in thread Thread-18 (request_thread):
Failed to issue request: Internal Server Error
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 971, in json
Failed to issue request: Internal Server Error
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 971, in json
Exception in thread Thread-17 (request_thread):
Traceback (most recent call last):
Traceback (most recent call last):
Exception in thread Thread-20 (request_thread):
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 971, in json
Exception in thread Thread-22 (request_thread):
Exception in thread Thread-12 (request_thread):
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 971, in json
Traceback (most recent call last):
Traceback (most recent call last):
Exception in thread Thread-10 (request_thread):
Traceback (most recent call last):
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 971, in json
Traceback (most recent call last):
Exception in thread Thread-23 (request_thread):
Exception in thread Thread-5 (request_thread):
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 971, in json
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 971, in json
Traceback (most recent call last):
Traceback (most recent call last):
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 971, in json
Traceback (most recent call last):
Traceback (most recent call last):
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 971, in json
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 971, in json
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 971, in json
Exception in thread Thread-8 (request_thread):
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 971, in json
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 971, in json
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 971, in json
Traceback (most recent call last):
    return complexjson.loads(self.text, **kwargs)
    return complexjson.loads(self.text, **kwargs)
    return complexjson.loads(self.text, **kwargs)
    return complexjson.loads(self.text, **kwargs)
    return complexjson.loads(self.text, **kwargs)
    return complexjson.loads(self.text, **kwargs)
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 971, in json
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/__init__.py", line 346, in loads
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/__init__.py", line 346, in loads
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/__init__.py", line 346, in loads
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/__init__.py", line 346, in loads
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/__init__.py", line 346, in loads
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/__init__.py", line 346, in loads
    return complexjson.loads(self.text, **kwargs)
    return complexjson.loads(self.text, **kwargs)
Traceback (most recent call last):
    return complexjson.loads(self.text, **kwargs)
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/__init__.py", line 346, in loads
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/__init__.py", line 346, in loads
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 971, in json
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/__init__.py", line 346, in loads
    return complexjson.loads(self.text, **kwargs)
    return _default_decoder.decode(s)
    return _default_decoder.decode(s)
    return _default_decoder.decode(s)
    return complexjson.loads(self.text, **kwargs)
    return _default_decoder.decode(s)
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 337, in decode
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
    return _default_decoder.decode(s)
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 337, in decode
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 337, in decode
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 337, in decode
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 337, in decode
    return _default_decoder.decode(s)
    return complexjson.loads(self.text, **kwargs)
    return complexjson.loads(self.text, **kwargs)
    return complexjson.loads(self.text, **kwargs)
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
    return _default_decoder.decode(s)
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
    return complexjson.loads(self.text, **kwargs)
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 337, in decode
    return complexjson.loads(self.text, **kwargs)
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/__init__.py", line 346, in loads
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 337, in decode
    return _default_decoder.decode(s)
Traceback (most recent call last):
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/__init__.py", line 346, in loads
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 337, in decode
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 355, in raw_decode
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 337, in decode
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 337, in decode
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 355, in raw_decode
    return _default_decoder.decode(s)
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/__init__.py", line 346, in loads
    return complexjson.loads(self.text, **kwargs)
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
    return _default_decoder.decode(s)
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 971, in json
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 337, in decode
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 355, in raw_decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
    return _default_decoder.decode(s)
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 337, in decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/__init__.py", line 346, in loads
    return _default_decoder.decode(s)
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 355, in raw_decode
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/__init__.py", line 346, in loads
    return complexjson.loads(self.text, **kwargs)
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/__init__.py", line 346, in loads
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 355, in raw_decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
    return _default_decoder.decode(s)
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 337, in decode
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 337, in decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())

During handling of the above exception, another exception occurred:

  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 355, in raw_decode
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 337, in decode
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 355, in raw_decode
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
Traceback (most recent call last):
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 355, in raw_decode
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
    raise JSONDecodeError("Expecting value", s, err.value) from None
    raise JSONDecodeError("Expecting value", s, err.value) from None
    return _default_decoder.decode(s)
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 337, in decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 355, in raw_decode

During handling of the above exception, another exception occurred:

    raise JSONDecodeError("Expecting value", s, err.value) from None
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

During handling of the above exception, another exception occurred:

    return _default_decoder.decode(s)
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 355, in raw_decode
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 355, in raw_decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
Traceback (most recent call last):
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

During handling of the above exception, another exception occurred:

  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 337, in decode
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
    raise JSONDecodeError("Expecting value", s, err.value) from None
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 355, in raw_decode
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

During handling of the above exception, another exception occurred:

json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

During handling of the above exception, another exception occurred:

    raise JSONDecodeError("Expecting value", s, err.value) from None
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 355, in raw_decode
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 355, in raw_decode
    raise JSONDecodeError("Expecting value", s, err.value) from None
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
Traceback (most recent call last):
    raise JSONDecodeError("Expecting value", s, err.value) from None
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

During handling of the above exception, another exception occurred:

json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
    raise JSONDecodeError("Expecting value", s, err.value) from None
Traceback (most recent call last):
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

During handling of the above exception, another exception occurred:

    raise JSONDecodeError("Expecting value", s, err.value) from None
Traceback (most recent call last):

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 337, in decode
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    raise JSONDecodeError("Expecting value", s, err.value) from None
Traceback (most recent call last):
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

During handling of the above exception, another exception occurred:

    raise JSONDecodeError("Expecting value", s, err.value) from None
Traceback (most recent call last):
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
Traceback (most recent call last):
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

During handling of the above exception, another exception occurred:

  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    raise JSONDecodeError("Expecting value", s, err.value) from None
Traceback (most recent call last):
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    obj, end = self.raw_decode(s, idx=_w(s, 0).end())
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

During handling of the above exception, another exception occurred:

  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 1016, in _bootstrap_inner

During handling of the above exception, another exception occurred:

  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/json/decoder.py", line 355, in raw_decode
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 1016, in _bootstrap_inner

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
Traceback (most recent call last):
    self.run()
    self.run()
    self.run()
    self.run()
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    raise JSONDecodeError("Expecting value", s, err.value) from None
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 953, in run
Traceback (most recent call last):
    self.run()
    self.run()
Traceback (most recent call last):
    self.run()
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 953, in run
    self.run()
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 953, in run
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 953, in run
    self.run()
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
    self.run()
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 953, in run
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 953, in run
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 953, in run
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 953, in run
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
    self._target(*self._args, **self._kwargs)
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 953, in run
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 953, in run
    self.run()
json.decoder.JSONDecodeError: Expecting value: line 1 column 1 (char 0)

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "/mnt/hwfile/huqinghao/xzyao/code/vllm/.artifact/benchmarks/tools/core.py", line 35, in request_thread
    self.run()
    self._target(*self._args, **self._kwargs)
    self._target(*self._args, **self._kwargs)
    self._target(*self._args, **self._kwargs)
    self._target(*self._args, **self._kwargs)
    self._target(*self._args, **self._kwargs)
  File "/mnt/hwfile/huqinghao/xzyao/code/vllm/.artifact/benchmarks/tools/core.py", line 35, in request_thread
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 953, in run
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
    self._target(*self._args, **self._kwargs)
  File "/mnt/hwfile/huqinghao/xzyao/code/vllm/.artifact/benchmarks/tools/core.py", line 35, in request_thread
    "response": res.json(),
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 953, in run
    self.run()
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
  File "/mnt/hwfile/huqinghao/xzyao/code/vllm/.artifact/benchmarks/tools/core.py", line 35, in request_thread
    self._target(*self._args, **self._kwargs)
    self._target(*self._args, **self._kwargs)
  File "/mnt/hwfile/huqinghao/xzyao/code/vllm/.artifact/benchmarks/tools/core.py", line 35, in request_thread
    self._target(*self._args, **self._kwargs)
    "response": res.json(),
  File "/mnt/hwfile/huqinghao/xzyao/code/vllm/.artifact/benchmarks/tools/core.py", line 35, in request_thread
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 953, in run
    self.run()
  File "/mnt/hwfile/huqinghao/xzyao/code/vllm/.artifact/benchmarks/tools/core.py", line 35, in request_thread
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    "response": res.json(),
    self._target(*self._args, **self._kwargs)
  File "/mnt/hwfile/huqinghao/xzyao/code/vllm/.artifact/benchmarks/tools/core.py", line 35, in request_thread
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 975, in json
    "response": res.json(),
    "response": res.json(),
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
    self._target(*self._args, **self._kwargs)
    "response": res.json(),
  File "/mnt/hwfile/huqinghao/xzyao/code/vllm/.artifact/benchmarks/tools/core.py", line 35, in request_thread
  File "/mnt/hwfile/huqinghao/xzyao/code/vllm/.artifact/benchmarks/tools/core.py", line 35, in request_thread
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 975, in json
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 975, in json
    self.run()
  File "/mnt/hwfile/huqinghao/xzyao/code/vllm/.artifact/benchmarks/tools/core.py", line 35, in request_thread
  File "/mnt/hwfile/huqinghao/xzyao/code/vllm/.artifact/benchmarks/tools/core.py", line 35, in request_thread
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 975, in json
    self._target(*self._args, **self._kwargs)
    "response": res.json(),
    "response": res.json(),
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 953, in run
    "response": res.json(),
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 975, in json
    raise RequestsJSONDecodeError(e.msg, e.doc, e.pos)
    raise RequestsJSONDecodeError(e.msg, e.doc, e.pos)
requests.exceptions.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
  File "/mnt/hwfile/huqinghao/xzyao/code/vllm/.artifact/benchmarks/tools/core.py", line 35, in request_thread
    "response": res.json(),
  File "/mnt/hwfile/huqinghao/xzyao/code/vllm/.artifact/benchmarks/tools/core.py", line 35, in request_thread
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 975, in json
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 975, in json
    "response": res.json(),
    raise RequestsJSONDecodeError(e.msg, e.doc, e.pos)
    self._target(*self._args, **self._kwargs)
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 975, in json
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 975, in json
    "response": res.json(),
    "response": res.json(),
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 975, in json
requests.exceptions.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
    raise RequestsJSONDecodeError(e.msg, e.doc, e.pos)
  File "/mnt/hwfile/huqinghao/xzyao/code/vllm/.artifact/benchmarks/tools/core.py", line 35, in request_thread
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 975, in json
    raise RequestsJSONDecodeError(e.msg, e.doc, e.pos)
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 975, in json
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 975, in json
    "response": res.json(),
    raise RequestsJSONDecodeError(e.msg, e.doc, e.pos)
  File "/mnt/hwfile/huqinghao/xzyao/code/vllm/.artifact/benchmarks/tools/core.py", line 35, in request_thread
    raise RequestsJSONDecodeError(e.msg, e.doc, e.pos)
    raise RequestsJSONDecodeError(e.msg, e.doc, e.pos)
    "response": res.json(),
  File "/mnt/hwfile/huqinghao/xzyao/code/vllm/.artifact/benchmarks/tools/core.py", line 35, in request_thread
    raise RequestsJSONDecodeError(e.msg, e.doc, e.pos)
    raise RequestsJSONDecodeError(e.msg, e.doc, e.pos)
requests.exceptions.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
    raise RequestsJSONDecodeError(e.msg, e.doc, e.pos)
requests.exceptions.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
requests.exceptions.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
requests.exceptions.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
requests.exceptions.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
    raise RequestsJSONDecodeError(e.msg, e.doc, e.pos)
requests.exceptions.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
    "response": res.json(),
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 975, in json
    "response": res.json(),
    self.run()
requests.exceptions.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
requests.exceptions.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
requests.exceptions.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 975, in json
    raise RequestsJSONDecodeError(e.msg, e.doc, e.pos)
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/threading.py", line 953, in run
requests.exceptions.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 975, in json
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 975, in json
    raise RequestsJSONDecodeError(e.msg, e.doc, e.pos)
requests.exceptions.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
    self._target(*self._args, **self._kwargs)
requests.exceptions.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
    raise RequestsJSONDecodeError(e.msg, e.doc, e.pos)
  File "/mnt/hwfile/huqinghao/xzyao/code/vllm/.artifact/benchmarks/tools/core.py", line 35, in request_thread
    raise RequestsJSONDecodeError(e.msg, e.doc, e.pos)
requests.exceptions.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
    "response": res.json(),
    raise RequestsJSONDecodeError(e.msg, e.doc, e.pos)
requests.exceptions.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
  File "/mnt/hwfile/huqinghao/miniconda3/lib/python3.10/site-packages/requests/models.py", line 975, in json
requests.exceptions.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
    raise RequestsJSONDecodeError(e.msg, e.doc, e.pos)
requests.exceptions.JSONDecodeError: Expecting value: line 1 column 1 (char 0)
INFO 05-06 04:50:07 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 0.3 tokens/s, Running: 8 reqs, Swapped: 0 reqs, Pending: 10 reqs, GPU KV cache usage: 0.1%, CPU KV cache usage: 0.0%
INFO 05-06 04:50:17 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 0.0 tokens/s, Running: 8 reqs, Swapped: 0 reqs, Pending: 10 reqs, GPU KV cache usage: 0.1%, CPU KV cache usage: 0.0%
INFO 05-06 04:50:27 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 0.0 tokens/s, Running: 8 reqs, Swapped: 0 reqs, Pending: 10 reqs, GPU KV cache usage: 0.1%, CPU KV cache usage: 0.0%
INFO 05-06 04:50:37 metrics.py:276] Avg prompt throughput: 0.0 tokens/s, Avg generation throughput: 0.0 tokens/s, Running: 8 reqs, Swapped: 0 reqs, Pending: 10 reqs, GPU KV cache usage: 0.1%, CPU KV cache usage: 0.0%
slurmstepd: error: *** JOB 3666646 ON HOST-10-140-60-4 CANCELLED AT 2024-05-06T04:50:46 ***
INFO:     Shutting down
INFO:     Waiting for application shutdown.
INFO:     Application shutdown complete.
INFO:     Finished server process [99271]
